# Product Requirements Document (PRD)
# VI-SLAM: Smartphone Visual-Inertial SLAM System

---

**문서 정보**

| 항목 | 내용 |
|------|------|
| 문서 버전 | 1.0.0 |
| 작성일 | 2026-01-20 |
| 상태 | Draft |
| 작성자 | VI-SLAM Project Team |
| 승인자 | - |

---

## 목차

1. [Executive Summary](#1-executive-summary)
2. [제품 비전](#2-제품-비전)
3. [문제 정의](#3-문제-정의)
4. [목표 및 성공 지표](#4-목표-및-성공-지표)
5. [사용자 분석](#5-사용자-분석)
6. [유스케이스](#6-유스케이스)
7. [기능 요구사항](#7-기능-요구사항)
8. [비기능 요구사항](#8-비기능-요구사항)
9. [기술 요구사항](#9-기술-요구사항)
10. [시스템 아키텍처](#10-시스템-아키텍처)
11. [제약 조건 및 가정](#11-제약-조건-및-가정)
12. [로드맵 및 마일스톤](#12-로드맵-및-마일스톤)
13. [리스크 분석](#13-리스크-분석)
14. [부록](#14-부록)

---

## 1. Executive Summary

### 1.1 제품 개요

**VI-SLAM**은 스마트폰의 카메라와 IMU 센서 데이터를 실시간으로 PC에 스트리밍하여 Visual-Inertial SLAM을 수행하는 시스템이다. 고가의 전용 장비 없이 일반 스마트폰만으로 6DoF 위치 추정 및 3D 환경 매핑을 가능하게 한다.

### 1.2 핵심 가치 제안

| 가치 | 설명 |
|------|------|
| **접근성** | 고가 장비 없이 스마트폰으로 VI-SLAM 구현 |
| **실시간성** | 100ms 이하 지연으로 실시간 위치 추정 |
| **정확성** | 0.1m 이하의 위치 추정 오차 달성 |
| **확장성** | 다양한 VI-SLAM 프레임워크 연동 지원 |

### 1.3 목표 시장

- AR/VR 애플리케이션 개발자
- 로보틱스 연구자 및 개발자
- 실내 측위 솔루션 개발자
- 3D 스캔/매핑 서비스 제공자

---

## 2. 제품 비전

### 2.1 비전 선언문

> "누구나 손에 든 스마트폰으로 정밀한 공간 인식 기술을 활용할 수 있게 한다."

### 2.2 장기 목표

```
Year 1: 스마트폰 → PC 실시간 VI-SLAM 시스템 완성
Year 2: 온디바이스 경량 VI-SLAM 구현
Year 3: 클라우드 기반 다중 사용자 협업 매핑 플랫폼
```

### 2.3 제품 포지셔닝

```
                    높음
                     ↑
           정확도    │    ┌─────────────┐
                     │    │  전용 장비   │
                     │    │ (LiDAR 등)  │
                     │    └─────────────┘
                     │              ┌─────────────┐
                     │              │  VI-SLAM    │ ← 목표
                     │              │ (본 제품)   │
                     │              └─────────────┘
                     │    ┌─────────────┐
                     │    │  GPS 기반   │
                     │    │ (실외 전용) │
                     │    └─────────────┘
           낮음 ─────┼────────────────────────────→ 높음
                     │                            접근성
                    비용 높음                    비용 낮음
```

---

## 3. 문제 정의

### 3.1 현재 상황 (As-Is)

| 문제 영역 | 현재 상황 | 영향 |
|----------|----------|------|
| **장비 비용** | 전용 VI-SLAM 장비 $500-$5,000 | 진입 장벽 높음 |
| **기술 복잡도** | 센서 동기화, 캘리브레이션 어려움 | 개발 시간 6개월+ |
| **통합 부재** | 분산된 오픈소스, 문서 부족 | 시행착오 비용 높음 |
| **실시간 처리** | 스마트폰 연산 능력 한계 | 지연 시간 문제 |

### 3.2 해결해야 할 핵심 문제

#### P1: 센서 데이터 동기화 문제

```
문제: 스마트폰의 카메라(30Hz)와 IMU(200Hz)는 서로 다른 클럭 사용
     → 수 밀리초의 시간 오프셋도 SLAM 정확도에 치명적

영향:
- 위치 추정 오차 10배 이상 증가
- 급격한 움직임에서 트래킹 실패
- 초기화 불안정
```

#### P2: 실시간 데이터 전송 문제

```
문제: 고대역폭 비디오 + 저지연 IMU 데이터의 동시 전송
     → 네트워크 지연이 SLAM 성능 저하 유발

영향:
- 100ms 이상 지연 시 실시간 응용 불가
- 패킷 손실 시 데이터 연속성 파괴
- 버퍼링으로 인한 추가 지연
```

#### P3: 스마트폰 센서 품질 문제

```
문제: 스마트폰 MEMS IMU의 높은 노이즈와 드리프트
     → 저품질 관성 데이터로 SLAM 정확도 저하

영향:
- 바이어스 드리프트로 적분 오차 누적
- Rolling Shutter로 인한 이미지 왜곡
- OIS 렌즈 움직임으로 캘리브레이션 오차
```

### 3.3 목표 상황 (To-Be)

| 문제 영역 | 목표 상황 | 개선 효과 |
|----------|----------|----------|
| **장비 비용** | 기존 스마트폰 활용 ($0 추가 비용) | 진입 장벽 제거 |
| **기술 복잡도** | 통합 가이드 및 설정 자동화 | 개발 시간 1개월 이내 |
| **통합 부재** | 엔드투엔드 솔루션 제공 | 시행착오 최소화 |
| **실시간 처리** | PC 오프로딩으로 실시간 처리 | < 100ms 지연 |

---

## 4. 목표 및 성공 지표

### 4.1 제품 목표

#### 1차 목표 (MVP)

| 목표 | 설명 | 우선순위 |
|------|------|---------|
| **G1** | 스마트폰 데이터 수집 앱 개발 | P0 |
| **G2** | PC 실시간 수신 모듈 개발 | P0 |
| **G3** | VINS-Mono 연동 | P0 |
| **G4** | 오프라인 데이터 처리 파이프라인 | P1 |

#### 2차 목표 (v1.0)

| 목표 | 설명 | 우선순위 |
|------|------|---------|
| **G5** | 실시간 스트리밍 구현 (< 100ms) | P1 |
| **G6** | 다중 프레임워크 지원 (OpenVINS, ORB-SLAM3) | P1 |
| **G7** | 자동 캘리브레이션 도구 | P2 |
| **G8** | iOS 앱 개발 | P2 |

### 4.2 성공 지표 (KPIs)

#### 기술 지표

| 지표 | 목표값 | 측정 방법 |
|------|--------|----------|
| **위치 정확도 (ATE RMSE)** | ≤ 0.1m | EuRoC 벤치마크 대비 |
| **엔드투엔드 지연** | ≤ 100ms | 네트워크 RTT + 처리 시간 |
| **IMU 샘플링 레이트** | ≥ 200Hz | 앱 내 측정 |
| **프레임 드롭률** | ≤ 1% | 연속 녹화 시 |
| **시스템 가동률** | ≥ 99% | 30분 연속 운용 |

#### 사용성 지표

| 지표 | 목표값 | 측정 방법 |
|------|--------|----------|
| **설치~첫 실행 시간** | ≤ 30분 | 사용자 테스트 |
| **캘리브레이션 시간** | ≤ 10분 | 가이드 기반 |
| **문서 완성도** | 100% | 모든 기능 문서화 |

#### 비즈니스 지표

| 지표 | 목표값 | 측정 방법 |
|------|--------|----------|
| **GitHub Stars** | ≥ 500 (1년 내) | GitHub 메트릭 |
| **커뮤니티 기여** | ≥ 10 PR/년 | GitHub 메트릭 |
| **지원 기기 수** | ≥ 20개 모델 | 호환성 테스트 |

---

## 5. 사용자 분석

### 5.1 사용자 페르소나

#### Persona 1: AR 개발자 김지훈

```
┌─────────────────────────────────────────────────────────┐
│ 김지훈 (32세, AR 스타트업 개발자)                         │
├─────────────────────────────────────────────────────────┤
│ 배경:                                                    │
│ • Unity/Unreal 기반 AR 앱 개발 3년 경력                  │
│ • ARCore/ARKit 사용 경험 있음                            │
│ • SLAM 이론은 알지만 구현 경험 없음                       │
├─────────────────────────────────────────────────────────┤
│ 목표:                                                    │
│ • ARCore 정확도 한계 극복                                │
│ • 자체 위치 추정 시스템 개발                              │
│ • 오프라인 동작 가능한 AR 앱 개발                         │
├─────────────────────────────────────────────────────────┤
│ 고충점:                                                  │
│ • SLAM 논문/코드 이해 어려움                             │
│ • 센서 캘리브레이션 방법 모름                             │
│ • 테스트 환경 구축 복잡함                                │
├─────────────────────────────────────────────────────────┤
│ 기대하는 솔루션:                                         │
│ • 단계별 가이드 문서                                     │
│ • 동작하는 샘플 코드                                     │
│ • 빠른 프로토타이핑 환경                                 │
└─────────────────────────────────────────────────────────┘
```

#### Persona 2: 로보틱스 연구원 박서연

```
┌─────────────────────────────────────────────────────────┐
│ 박서연 (28세, 대학원 로보틱스 연구원)                     │
├─────────────────────────────────────────────────────────┤
│ 배경:                                                    │
│ • 컴퓨터 비전/SLAM 석사 과정                              │
│ • ROS 사용 경험 풍부                                     │
│ • 연구용 데이터 수집 필요                                 │
├─────────────────────────────────────────────────────────┤
│ 목표:                                                    │
│ • 논문용 비교 실험 데이터 수집                            │
│ • 새로운 알고리즘 테스트                                  │
│ • 다양한 환경에서의 성능 평가                             │
├─────────────────────────────────────────────────────────┤
│ 고충점:                                                  │
│ • 연구실 예산 제한으로 고가 장비 구매 어려움               │
│ • 기존 데이터셋 다양성 부족                               │
│ • 센서 동기화 검증 어려움                                 │
├─────────────────────────────────────────────────────────┤
│ 기대하는 솔루션:                                         │
│ • 저비용 데이터 수집 환경                                │
│ • 정확한 타임스탬프 동기화                               │
│ • 다양한 SLAM 프레임워크 연동                            │
└─────────────────────────────────────────────────────────┘
```

#### Persona 3: 실내 측위 솔루션 기업 CTO 이민수

```
┌─────────────────────────────────────────────────────────┐
│ 이민수 (40세, 실내 측위 스타트업 CTO)                     │
├─────────────────────────────────────────────────────────┤
│ 배경:                                                    │
│ • 위치 기반 서비스 개발 10년 경력                         │
│ • BLE 비콘 기반 실내 측위 서비스 운영 중                  │
│ • 정확도 개선 방안 탐색 중                                │
├─────────────────────────────────────────────────────────┤
│ 목표:                                                    │
│ • 비콘 설치 비용 절감                                    │
│ • 측위 정확도 1m 이내 달성                               │
│ • 빠른 PoC 개발                                         │
├─────────────────────────────────────────────────────────┤
│ 고충점:                                                  │
│ • 기존 비콘 솔루션 정확도 한계 (2-5m)                    │
│ • 초기 인프라 설치 비용 높음                             │
│ • 새로운 기술 검증 리스크                                │
├─────────────────────────────────────────────────────────┤
│ 기대하는 솔루션:                                         │
│ • 인프라 없는 측위 솔루션                                │
│ • 상용 라이선스 (BSD)                                   │
│ • 기술 지원 및 문서                                      │
└─────────────────────────────────────────────────────────┘
```

### 5.2 사용자 여정 맵

```
┌──────────────────────────────────────────────────────────────────────────┐
│                            사용자 여정 맵                                  │
├──────────────────────────────────────────────────────────────────────────┤
│ 단계    │ 인지        │ 탐색        │ 설치        │ 사용        │ 확장   │
├──────────────────────────────────────────────────────────────────────────┤
│ 행동    │ SLAM 검색   │ 문서 확인   │ 환경 구축   │ 데이터 수집 │ 커스터 │
│         │ GitHub 발견 │ 요구사항    │ 앱 설치     │ SLAM 실행   │ 마이징 │
│         │             │ 확인        │ PC 설정     │             │        │
├──────────────────────────────────────────────────────────────────────────┤
│ 터치    │ GitHub      │ README      │ 설치 가이드 │ 앱 UI       │ API    │
│ 포인트  │ 검색 결과   │ 문서 사이트 │ 스크립트    │ 터미널 출력 │ 문서   │
├──────────────────────────────────────────────────────────────────────────┤
│ 감정    │ 기대        │ 흥미 ↗      │ 불안 ↘      │ 만족 ↗      │ 도전 → │
│         │             │ "이거다!"   │ "될까?"     │ "된다!"     │ 성취감 │
├──────────────────────────────────────────────────────────────────────────┤
│ 고충점  │ 정보 분산   │ 요구사항    │ 의존성      │ 캘리브레이션│ API    │
│         │             │ 불명확      │ 충돌        │ 어려움      │ 부족   │
├──────────────────────────────────────────────────────────────────────────┤
│ 기회    │ SEO 최적화  │ Quick Start │ 원클릭      │ 자동 캘리   │ 플러그인│
│         │             │ 가이드      │ 설치 스크립트│ 브레이션    │ 시스템 │
└──────────────────────────────────────────────────────────────────────────┘
```

---

## 6. 유스케이스

### 6.1 유스케이스 다이어그램

```
                          ┌─────────────────────────────────┐
                          │         VI-SLAM System          │
                          │                                 │
    ┌─────────┐           │  ┌─────────────────────────┐   │
    │         │           │  │                         │   │
    │ AR/VR   │──────────────│  UC1: 실시간 위치 추정  │   │
    │ 개발자  │           │  │                         │   │
    │         │──────┐    │  └─────────────────────────┘   │
    └─────────┘      │    │                                 │
                     │    │  ┌─────────────────────────┐   │
    ┌─────────┐      │    │  │                         │   │
    │         │      └───────│  UC2: 데이터 수집/저장   │   │
    │ 연구원  │──────────────│                         │   │
    │         │──────┐    │  └─────────────────────────┘   │
    └─────────┘      │    │                                 │
                     │    │  ┌─────────────────────────┐   │
    ┌─────────┐      │    │  │                         │   │
    │         │      └───────│  UC3: 오프라인 SLAM 처리│   │
    │ 매핑    │──────────────│                         │   │
    │ 엔지니어│           │  └─────────────────────────┘   │
    │         │──────┐    │                                 │
    └─────────┘      │    │  ┌─────────────────────────┐   │
                     │    │  │                         │   │
                     └───────│  UC4: 센서 캘리브레이션 │   │
                          │  │                         │   │
                          │  └─────────────────────────┘   │
                          │                                 │
                          │  ┌─────────────────────────┐   │
                          │  │                         │   │
                          │  │  UC5: 3D 맵 생성/저장   │   │
                          │  │                         │   │
                          │  └─────────────────────────┘   │
                          │                                 │
                          └─────────────────────────────────┘
```

### 6.2 상세 유스케이스

#### UC1: 실시간 위치 추정

```
┌─────────────────────────────────────────────────────────────┐
│ UC1: 실시간 위치 추정                                        │
├─────────────────────────────────────────────────────────────┤
│ 액터: AR/VR 개발자, 로봇 운영자                              │
│ 선행 조건: 캘리브레이션 완료, 네트워크 연결                   │
│ 후행 조건: 6DoF 포즈 연속 출력                               │
├─────────────────────────────────────────────────────────────┤
│ 기본 흐름:                                                   │
│ 1. 사용자가 스마트폰 앱 실행                                 │
│ 2. 앱이 PC 서버와 연결 확인                                  │
│ 3. 사용자가 "시작" 버튼 탭                                   │
│ 4. 앱이 카메라/IMU 데이터 캡처 시작                          │
│ 5. 앱이 데이터를 PC로 실시간 스트리밍                        │
│ 6. PC가 데이터 수신 및 동기화                                │
│ 7. VI-SLAM 엔진이 위치 추정                                  │
│ 8. 시스템이 6DoF 포즈 출력 (30Hz)                            │
│ 9. 사용자가 "중지" 버튼 탭                                   │
│ 10. 시스템이 세션 종료                                       │
├─────────────────────────────────────────────────────────────┤
│ 대안 흐름:                                                   │
│ 4a. 트래킹 손실 시:                                          │
│     → 시스템이 재초기화 시도                                 │
│     → 3회 실패 시 사용자에게 알림                            │
│ 5a. 네트워크 연결 끊김 시:                                   │
│     → 앱이 로컬 버퍼에 데이터 저장                           │
│     → 연결 복구 후 동기화                                    │
├─────────────────────────────────────────────────────────────┤
│ 성공 지표:                                                   │
│ • 엔드투엔드 지연 < 100ms                                    │
│ • 위치 정확도 < 0.1m                                         │
│ • 트래킹 유지율 > 95%                                        │
└─────────────────────────────────────────────────────────────┘
```

#### UC2: 데이터 수집 및 저장

```
┌─────────────────────────────────────────────────────────────┐
│ UC2: 데이터 수집 및 저장                                     │
├─────────────────────────────────────────────────────────────┤
│ 액터: 연구원, 데이터 엔지니어                                │
│ 선행 조건: 앱 설치, 저장 공간 확보                           │
│ 후행 조건: 동기화된 데이터셋 생성                            │
├─────────────────────────────────────────────────────────────┤
│ 기본 흐름:                                                   │
│ 1. 사용자가 녹화 설정 구성 (해상도, IMU 주파수 등)           │
│ 2. 사용자가 "녹화" 버튼 탭                                   │
│ 3. 앱이 카메라/IMU 데이터 동기 캡처                          │
│ 4. 앱이 로컬 저장소에 데이터 저장                            │
│ 5. 앱이 실시간 통계 표시 (프레임 수, IMU 샘플 수)            │
│ 6. 사용자가 "중지" 버튼 탭                                   │
│ 7. 앱이 메타데이터 파일 생성                                 │
│ 8. 앱이 데이터 무결성 검증                                   │
│ 9. 사용자가 데이터 내보내기                                  │
├─────────────────────────────────────────────────────────────┤
│ 출력 파일:                                                   │
│ • video.mp4 (H.264 인코딩 비디오)                            │
│ • imu.csv (타임스탬프, ax, ay, az, gx, gy, gz)               │
│ • metadata.json (캘리브레이션, 기기 정보)                    │
│ • frames/ (선택: 개별 프레임 이미지)                         │
├─────────────────────────────────────────────────────────────┤
│ 성공 지표:                                                   │
│ • 프레임 드롭률 < 1%                                         │
│ • IMU 샘플링 정확도 ±5%                                      │
│ • 타임스탬프 정확도 < 1ms                                    │
└─────────────────────────────────────────────────────────────┘
```

#### UC3: 오프라인 SLAM 처리

```
┌─────────────────────────────────────────────────────────────┐
│ UC3: 오프라인 SLAM 처리                                      │
├─────────────────────────────────────────────────────────────┤
│ 액터: 연구원, 매핑 엔지니어                                  │
│ 선행 조건: 수집된 데이터셋, SLAM 프레임워크 설치             │
│ 후행 조건: 궤적 파일, 포인트 클라우드 생성                   │
├─────────────────────────────────────────────────────────────┤
│ 기본 흐름:                                                   │
│ 1. 사용자가 데이터셋 디렉토리 선택                           │
│ 2. 시스템이 데이터 형식 검증                                 │
│ 3. 시스템이 선택된 SLAM 프레임워크 설정 로드                 │
│ 4. 사용자가 "처리 시작" 클릭                                 │
│ 5. 시스템이 데이터를 SLAM 프레임워크로 입력                  │
│ 6. 시스템이 진행률 표시                                      │
│ 7. SLAM 엔진이 궤적 추정                                     │
│ 8. 시스템이 결과 파일 저장                                   │
│ 9. 시스템이 결과 시각화 제공                                 │
├─────────────────────────────────────────────────────────────┤
│ 출력:                                                        │
│ • trajectory.txt (TUM 형식 궤적)                             │
│ • pointcloud.ply (3D 포인트 클라우드)                        │
│ • keyframes/ (키프레임 이미지)                               │
│ • report.html (처리 통계, 시각화)                            │
└─────────────────────────────────────────────────────────────┘
```

#### UC4: 센서 캘리브레이션

```
┌─────────────────────────────────────────────────────────────┐
│ UC4: 센서 캘리브레이션                                       │
├─────────────────────────────────────────────────────────────┤
│ 액터: 모든 사용자                                            │
│ 선행 조건: 캘리브레이션 타겟 준비 (체커보드/Aprilgrid)       │
│ 후행 조건: 캘리브레이션 파라미터 파일 생성                   │
├─────────────────────────────────────────────────────────────┤
│ 기본 흐름:                                                   │
│                                                              │
│ [카메라 Intrinsic 캘리브레이션]                              │
│ 1. 앱에서 캘리브레이션 모드 선택                             │
│ 2. 사용자가 체커보드를 다양한 각도로 촬영 (20장+)            │
│ 3. 앱이 코너 검출 및 피드백 제공                             │
│ 4. 앱이 카메라 파라미터 계산                                 │
│ 5. 앱이 Reprojection error 표시                              │
│                                                              │
│ [Camera-IMU Extrinsic 캘리브레이션]                          │
│ 6. 사용자가 기기를 다양한 방향으로 움직임 (60초)             │
│ 7. 시스템이 Kalibr로 extrinsic 계산                          │
│ 8. 시스템이 시간 오프셋 추정                                 │
│                                                              │
│ [검증]                                                       │
│ 9. 사용자가 검증 시퀀스 녹화                                 │
│ 10. 시스템이 캘리브레이션 정확도 검증                        │
│ 11. 시스템이 calibration.yaml 저장                           │
├─────────────────────────────────────────────────────────────┤
│ 성공 지표:                                                   │
│ • Reprojection error < 0.5 pixel                             │
│ • 시간 오프셋 추정 정확도 < 1ms                              │
└─────────────────────────────────────────────────────────────┘
```

### 6.3 사용자 스토리

| ID | 역할 | 스토리 | 우선순위 | 수용 기준 |
|----|------|--------|---------|----------|
| US01 | AR 개발자 | 스마트폰 앱을 설치하고 PC와 연결하여 실시간 위치를 받고 싶다 | P0 | 30초 내 연결, 30Hz 포즈 출력 |
| US02 | 연구원 | 카메라/IMU 데이터를 동기화하여 저장하고 싶다 | P0 | 타임스탬프 오차 < 1ms |
| US03 | 개발자 | 저장된 데이터로 다양한 SLAM 알고리즘을 테스트하고 싶다 | P0 | 3개+ 프레임워크 지원 |
| US04 | 모든 사용자 | 앱 내에서 카메라 캘리브레이션을 수행하고 싶다 | P1 | 10분 내 완료 |
| US05 | AR 개발자 | SLAM 결과를 Unity/Unreal에서 사용하고 싶다 | P1 | SDK/플러그인 제공 |
| US06 | 연구원 | 여러 스마트폰 모델의 성능을 비교하고 싶다 | P2 | 벤치마크 도구 제공 |
| US07 | iOS 개발자 | iPhone에서도 데이터를 수집하고 싶다 | P2 | iOS 앱 제공 |
| US08 | 매핑 엔지니어 | 생성된 3D 맵을 내보내고 싶다 | P2 | PLY/OBJ 형식 지원 |

---

## 7. 기능 요구사항

### 7.1 기능 요구사항 개요

```
┌─────────────────────────────────────────────────────────────────────────┐
│                          기능 요구사항 계층                               │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                          │
│  ┌─────────────────────────────────────────────────────────────────┐    │
│  │                    Application Layer                             │    │
│  │  ┌───────────────┐  ┌───────────────┐  ┌───────────────┐       │    │
│  │  │ Android App   │  │   iOS App     │  │   PC Client   │       │    │
│  │  │  (FR1.x)      │  │  (FR2.x)      │  │   (FR3.x)     │       │    │
│  │  └───────────────┘  └───────────────┘  └───────────────┘       │    │
│  └─────────────────────────────────────────────────────────────────┘    │
│                                    │                                     │
│  ┌─────────────────────────────────▼───────────────────────────────┐    │
│  │                    Communication Layer                           │    │
│  │  ┌───────────────┐  ┌───────────────┐  ┌───────────────┐       │    │
│  │  │  Streaming    │  │    Sync       │  │   Protocol    │       │    │
│  │  │  (FR4.x)      │  │   (FR5.x)     │  │   (FR6.x)     │       │    │
│  │  └───────────────┘  └───────────────┘  └───────────────┘       │    │
│  └─────────────────────────────────────────────────────────────────┘    │
│                                    │                                     │
│  ┌─────────────────────────────────▼───────────────────────────────┐    │
│  │                    Processing Layer                              │    │
│  │  ┌───────────────┐  ┌───────────────┐  ┌───────────────┐       │    │
│  │  │  VI-SLAM      │  │ Calibration   │  │   Output      │       │    │
│  │  │  (FR7.x)      │  │   (FR8.x)     │  │   (FR9.x)     │       │    │
│  │  └───────────────┘  └───────────────┘  └───────────────┘       │    │
│  └─────────────────────────────────────────────────────────────────┘    │
│                                                                          │
└─────────────────────────────────────────────────────────────────────────┘
```

### 7.2 FR1: Android 앱 기능

| ID | 기능 | 설명 | 우선순위 |
|----|------|------|---------|
| FR1.1 | 카메라 캡처 | Camera2 API로 프레임 캡처 (30Hz, 720p/1080p) | P0 |
| FR1.2 | IMU 캡처 | 가속도계/자이로스코프 데이터 캡처 (200Hz) | P0 |
| FR1.3 | 타임스탬프 동기화 | 카메라/IMU 타임스탬프 통합 관리 | P0 |
| FR1.4 | 로컬 저장 | 비디오/IMU 데이터 로컬 저장 | P0 |
| FR1.5 | 실시간 스트리밍 | PC로 데이터 실시간 전송 | P1 |
| FR1.6 | 설정 UI | 해상도, FPS, IMU 주파수 설정 | P1 |
| FR1.7 | 상태 표시 | 연결 상태, FPS, 버퍼 상태 표시 | P1 |
| FR1.8 | 캘리브레이션 UI | 앱 내 캘리브레이션 가이드 | P2 |
| FR1.9 | OIS 비활성화 | 광학 이미지 안정화 비활성화 옵션 | P2 |

#### FR1.1 상세: 카메라 캡처

```yaml
기능명: 카메라 캡처
ID: FR1.1
우선순위: P0

설명: |
  Camera2 API를 사용하여 후면 카메라에서 프레임을 캡처한다.
  각 프레임에 정확한 센서 타임스탬프를 포함한다.

입력:
  - 해상도 설정 (720p/1080p)
  - FPS 설정 (15/30/60)
  - 노출 모드 (자동/수동)

출력:
  - YUV420 또는 JPEG 프레임
  - 센서 타임스탬프 (나노초)
  - 프레임 메타데이터 (노출 시간, ISO 등)

요구사항:
  - Camera2 API HARDWARE_LEVEL_FULL 이상 지원 기기
  - SENSOR_TIMESTAMP 사용
  - 최소 30Hz 안정적 캡처

수용 기준:
  - [ ] 30Hz에서 프레임 드롭률 < 1%
  - [ ] 타임스탬프 정확도 < 1ms
  - [ ] 메모리 누수 없음 (1시간 연속 운용)
```

#### FR1.2 상세: IMU 캡처

```yaml
기능명: IMU 캡처
ID: FR1.2
우선순위: P0

설명: |
  SensorManager를 사용하여 가속도계와 자이로스코프 데이터를
  고주파수로 캡처한다.

입력:
  - 목표 샘플링 주파수 (100-500Hz)
  - 센서 유형 (Uncalibrated/Calibrated)

출력:
  - 가속도 (ax, ay, az) m/s²
  - 각속도 (gx, gy, gz) rad/s
  - 센서 타임스탬프 (나노초)

요구사항:
  - SENSOR_DELAY_FASTEST 사용
  - Uncalibrated 센서 옵션 제공
  - 순환 버퍼로 최근 데이터 유지

수용 기준:
  - [ ] 실제 샘플링 레이트 ≥ 목표의 95%
  - [ ] 샘플 손실률 < 0.1%
  - [ ] 타임스탬프 단조 증가 보장
```

### 7.3 FR2: iOS 앱 기능 (Phase 2)

| ID | 기능 | 설명 | 우선순위 |
|----|------|------|---------|
| FR2.1 | 카메라 캡처 | AVFoundation으로 프레임 캡처 | P2 |
| FR2.2 | IMU 캡처 | CoreMotion으로 IMU 데이터 캡처 | P2 |
| FR2.3 | 타임스탬프 동기화 | 카메라/IMU 타임스탬프 통합 | P2 |
| FR2.4 | 로컬 저장 | 데이터 로컬 저장 | P2 |
| FR2.5 | 스트리밍 | PC로 실시간 전송 | P2 |

### 7.4 FR3: PC 클라이언트 기능

| ID | 기능 | 설명 | 우선순위 |
|----|------|------|---------|
| FR3.1 | 데이터 수신 | 스마트폰 데이터 수신 | P0 |
| FR3.2 | 비디오 디코딩 | H.264/H.265 디코딩 | P0 |
| FR3.3 | 데이터 동기화 | 비디오/IMU 타임스탬프 정렬 | P0 |
| FR3.4 | SLAM 연동 | VI-SLAM 프레임워크 연동 | P0 |
| FR3.5 | 시각화 | 궤적/포인트클라우드 실시간 표시 | P1 |
| FR3.6 | 데이터 저장 | 수신 데이터 로컬 저장 | P1 |
| FR3.7 | ROS 연동 | ROS 토픽 퍼블리시 | P1 |

#### FR3.4 상세: SLAM 프레임워크 연동

```yaml
기능명: VI-SLAM 프레임워크 연동
ID: FR3.4
우선순위: P0

지원 프레임워크:
  1순위 (P0):
    - VINS-Mono: 스마트폰 데이터 최적 지원

  2순위 (P1):
    - OpenVINS: MSCKF 기반, 연구용
    - ORB-SLAM3: 최고 정확도
    - Basalt: 최고 속도, BSD 라이선스

인터페이스:
  입력:
    - 이미지: cv::Mat (grayscale/color)
    - IMU: timestamp, acc[3], gyro[3]
    - 캘리브레이션: YAML 파일

  출력:
    - 6DoF 포즈: position (x,y,z), orientation (qw,qx,qy,qz)
    - 상태: INITIALIZING, TRACKING, LOST
    - 선택: 3D 포인트 클라우드

수용 기준:
  - [ ] VINS-Mono 연동 완료 및 EuRoC 테스트 통과
  - [ ] 위치 정확도 ATE RMSE < 0.15m
  - [ ] 실시간 처리 (입력 30Hz, 출력 30Hz)
```

### 7.5 FR4: 스트리밍 기능

| ID | 기능 | 설명 | 우선순위 |
|----|------|------|---------|
| FR4.1 | WebRTC 비디오 | WebRTC로 비디오 스트리밍 | P1 |
| FR4.2 | UDP IMU | UDP로 IMU 데이터 전송 | P1 |
| FR4.3 | 연결 관리 | 연결 상태 모니터링 및 재연결 | P1 |
| FR4.4 | 버퍼링 | 네트워크 지터 흡수 버퍼 | P1 |
| FR4.5 | 대역폭 적응 | 네트워크 상태에 따른 품질 조절 | P2 |

### 7.6 FR5: 동기화 기능

| ID | 기능 | 설명 | 우선순위 |
|----|------|------|---------|
| FR5.1 | 타임스탬프 정렬 | 비디오/IMU 타임스탬프 정렬 | P0 |
| FR5.2 | IMU 보간 | 프레임 시간에 맞춘 IMU 보간 | P0 |
| FR5.3 | 드롭 프레임 처리 | 프레임 드롭 시 데이터 연속성 유지 | P1 |
| FR5.4 | 지연 보정 | 네트워크 지연 측정 및 보정 | P1 |

### 7.7 FR6: 데이터 형식

| ID | 기능 | 설명 | 우선순위 |
|----|------|------|---------|
| FR6.1 | EuRoC 형식 | EuRoC 데이터셋 형식 지원 | P0 |
| FR6.2 | TUM 형식 | TUM VI 데이터셋 형식 지원 | P1 |
| FR6.3 | ROS bag | rosbag 형식 내보내기 | P1 |
| FR6.4 | CSV/Binary | 원시 데이터 CSV/Binary 저장 | P0 |

### 7.8 FR7: VI-SLAM 처리

| ID | 기능 | 설명 | 우선순위 |
|----|------|------|---------|
| FR7.1 | 초기화 | VI-SLAM 자동 초기화 | P0 |
| FR7.2 | 트래킹 | 연속 포즈 추정 | P0 |
| FR7.3 | 맵 관리 | 포인트 클라우드 관리 | P1 |
| FR7.4 | 루프 클로징 | 루프 감지 및 최적화 | P2 |
| FR7.5 | 재위치화 | 트래킹 손실 후 복구 | P1 |

### 7.9 FR8: 캘리브레이션

| ID | 기능 | 설명 | 우선순위 |
|----|------|------|---------|
| FR8.1 | 카메라 Intrinsic | 초점거리, 주점, 왜곡계수 | P0 |
| FR8.2 | Camera-IMU Extrinsic | 상대 위치/자세 | P1 |
| FR8.3 | 시간 오프셋 | 카메라-IMU 시간 오프셋 | P1 |
| FR8.4 | IMU 노이즈 파라미터 | Allan Variance 기반 추정 | P2 |
| FR8.5 | 자동 캘리브레이션 | 가이드 기반 자동화 | P2 |

### 7.10 FR9: 출력 및 내보내기

| ID | 기능 | 설명 | 우선순위 |
|----|------|------|---------|
| FR9.1 | 궤적 내보내기 | TUM/KITTI 형식 궤적 | P0 |
| FR9.2 | 포인트 클라우드 | PLY/PCD 형식 맵 | P1 |
| FR9.3 | 메시 | OBJ/PLY 3D 메시 | P2 |
| FR9.4 | 실시간 API | 포즈 스트리밍 API | P1 |

---

## 8. 비기능 요구사항

### 8.1 NFR1: 성능 요구사항

| ID | 요구사항 | 목표값 | 측정 방법 |
|----|----------|--------|----------|
| NFR1.1 | 엔드투엔드 지연 | < 100ms | 타임스탬프 차이 |
| NFR1.2 | 위치 정확도 | ATE RMSE < 0.1m | EuRoC 벤치마크 |
| NFR1.3 | 처리 속도 | ≥ 30 FPS | 프레임워크 출력 |
| NFR1.4 | IMU 샘플링 레이트 | ≥ 200 Hz | 앱 내 측정 |
| NFR1.5 | 프레임 드롭률 | < 1% | 연속 녹화 시 |
| NFR1.6 | CPU 사용률 (앱) | < 50% | 프로파일러 |
| NFR1.7 | 메모리 사용 (앱) | < 500 MB | 프로파일러 |

### 8.2 NFR2: 신뢰성 요구사항

| ID | 요구사항 | 목표값 | 측정 방법 |
|----|----------|--------|----------|
| NFR2.1 | 시스템 가동률 | ≥ 99% | 30분 연속 운용 |
| NFR2.2 | 트래킹 유지율 | ≥ 95% | 정상 환경 기준 |
| NFR2.3 | 데이터 무결성 | 100% | 체크섬 검증 |
| NFR2.4 | 오류 복구 | 자동 재연결 | 네트워크 끊김 시 |
| NFR2.5 | 크래시율 | < 0.1% | 세션당 |

### 8.3 NFR3: 사용성 요구사항

| ID | 요구사항 | 목표값 | 측정 방법 |
|----|----------|--------|----------|
| NFR3.1 | 설치 시간 | < 30분 | 사용자 테스트 |
| NFR3.2 | 캘리브레이션 시간 | < 10분 | 가이드 기반 |
| NFR3.3 | 학습 곡선 | 1일 내 기본 사용 | 사용자 피드백 |
| NFR3.4 | 문서 커버리지 | 100% | 모든 기능 문서화 |
| NFR3.5 | 에러 메시지 명확성 | 해결 방법 포함 | 사용자 피드백 |

### 8.4 NFR4: 호환성 요구사항

| ID | 요구사항 | 목표값 |
|----|----------|--------|
| NFR4.1 | Android 버전 | 8.0 (API 26) 이상 |
| NFR4.2 | iOS 버전 | 11.0 이상 (Phase 2) |
| NFR4.3 | PC OS | Ubuntu 20.04/22.04, Windows 10/11 (WSL) |
| NFR4.4 | ROS 버전 | Noetic, Humble |
| NFR4.5 | 지원 기기 수 | ≥ 20개 스마트폰 모델 |

### 8.5 NFR5: 보안 요구사항

| ID | 요구사항 | 설명 |
|----|----------|------|
| NFR5.1 | 데이터 전송 암호화 | DTLS (WebRTC) 사용 |
| NFR5.2 | 로컬 데이터 보호 | 앱 전용 저장소 사용 |
| NFR5.3 | 권한 최소화 | 필요한 권한만 요청 |
| NFR5.4 | 네트워크 인증 | 선택적 연결 인증 |

### 8.6 NFR6: 유지보수성 요구사항

| ID | 요구사항 | 목표값 |
|----|----------|--------|
| NFR6.1 | 코드 커버리지 | ≥ 70% |
| NFR6.2 | 문서화 수준 | 모든 public API |
| NFR6.3 | 모듈 결합도 | 느슨한 결합 |
| NFR6.4 | CI/CD | 자동 빌드/테스트 |

---

## 9. 기술 요구사항

### 9.1 하드웨어 요구사항

#### 스마트폰 (최소/권장)

| 항목 | 최소 | 권장 |
|------|------|------|
| **Android 버전** | 8.0 | 11.0+ |
| **Camera2 API** | HARDWARE_LEVEL_LIMITED | HARDWARE_LEVEL_FULL |
| **RAM** | 2 GB | 4 GB+ |
| **저장 공간** | 100 MB (앱) + 1 GB (데이터) | 10 GB+ |
| **센서** | 가속도계, 자이로스코프 | + 자력계, 기압계 |

#### PC (최소/권장)

| 항목 | 최소 | 권장 |
|------|------|------|
| **OS** | Ubuntu 18.04 | Ubuntu 20.04/22.04 |
| **CPU** | Intel i5 / AMD Ryzen 5 | Intel i7 / AMD Ryzen 7 |
| **RAM** | 8 GB | 16 GB+ |
| **GPU** | 내장 그래픽 | NVIDIA GTX 1060+ |
| **저장 공간** | 50 GB | 200 GB+ SSD |

#### 네트워크

| 항목 | 최소 | 권장 |
|------|------|------|
| **연결** | 2.4 GHz WiFi | 5 GHz WiFi / USB 테더링 |
| **대역폭** | 5 Mbps | 20 Mbps+ |
| **지연** | < 50 ms | < 20 ms |

### 9.2 소프트웨어 요구사항

#### 개발 환경

| 컴포넌트 | 도구 | 버전 |
|---------|------|------|
| **Android 앱** | Android Studio | 2023.1+ |
| **Android SDK** | - | API 26-34 |
| **Kotlin** | - | 1.9+ |
| **PC 클라이언트** | Python | 3.8+ |
| **C++ 컴파일러** | GCC / Clang | 9+ / 10+ |
| **빌드 시스템** | CMake | 3.16+ |
| **ROS** | ROS Noetic / Humble | - |

#### 의존성

```yaml
Android 앱:
  - Camera2 API
  - SensorManager
  - WebRTC (Google libwebrtc)
  - Gson (JSON 처리)
  - Kotlin Coroutines

PC 클라이언트:
  - OpenCV: 4.5+
  - Eigen3: 3.3+
  - Ceres Solver: 2.0+
  - aiortc (WebRTC)
  - numpy, scipy

VI-SLAM 프레임워크:
  - VINS-Mono: 자체 의존성
  - OpenVINS: ROS 의존
  - ORB-SLAM3: Pangolin, DBoW2
  - Basalt: TBB, fmt
```

### 9.3 데이터 형식 명세

#### IMU 데이터 형식

```
# CSV 형식
# timestamp (ns), ax (m/s²), ay, az, gx (rad/s), gy, gz
1000000000,0.1,-0.2,9.8,0.001,-0.002,0.001
1005000000,0.1,-0.2,9.8,0.001,-0.002,0.001
...

# Binary 형식 (각 샘플 56 bytes)
struct ImuSample {
    int64_t timestamp;    // 8 bytes
    double acc[3];        // 24 bytes
    double gyro[3];       // 24 bytes
};
```

#### 비디오 메타데이터 형식

```json
{
  "format_version": "1.0",
  "device": {
    "model": "Pixel 6",
    "manufacturer": "Google",
    "android_version": "12"
  },
  "camera": {
    "resolution": [1920, 1080],
    "fps": 30,
    "codec": "H.264",
    "timestamp_source": "SENSOR_TIMESTAMP"
  },
  "calibration": {
    "fx": 1500.0,
    "fy": 1500.0,
    "cx": 960.0,
    "cy": 540.0,
    "distortion": [-0.28, 0.07, 0.0, 0.0]
  },
  "recording": {
    "start_time": "2026-01-20T10:00:00Z",
    "duration_ms": 60000,
    "frame_count": 1800,
    "imu_sample_count": 12000
  }
}
```

---

## 10. 시스템 아키텍처

### 10.1 전체 시스템 아키텍처

```
┌─────────────────────────────────────────────────────────────────────────┐
│                              VI-SLAM SYSTEM                              │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                          │
│  ┌──────────────────────────────────────────────────────────────────┐   │
│  │                    SMARTPHONE (Android/iOS)                       │   │
│  │  ┌────────────────┐  ┌────────────────┐  ┌────────────────┐     │   │
│  │  │  Camera Module │  │   IMU Module   │  │  Sync Module   │     │   │
│  │  │  (Camera2 API) │  │ (SensorManager)│  │  (Timestamp)   │     │   │
│  │  └───────┬────────┘  └───────┬────────┘  └───────┬────────┘     │   │
│  │          │                   │                   │               │   │
│  │          └───────────────────┼───────────────────┘               │   │
│  │                              ▼                                    │   │
│  │  ┌──────────────────────────────────────────────────────────┐   │   │
│  │  │                   Data Manager                            │   │   │
│  │  │  ┌────────────┐  ┌────────────┐  ┌────────────┐          │   │   │
│  │  │  │   Buffer   │  │   Encoder  │  │  Streamer  │          │   │   │
│  │  │  │  Manager   │  │  (H.264)   │  │  (WebRTC)  │          │   │   │
│  │  │  └────────────┘  └────────────┘  └────────────┘          │   │   │
│  │  └──────────────────────────────────────────────────────────┘   │   │
│  └──────────────────────────────────────────────────────────────────┘   │
│                                    │                                     │
│                      ┌─────────────┴─────────────┐                      │
│                      │      Network Layer        │                      │
│                      │  ┌─────────┐ ┌─────────┐  │                      │
│                      │  │ WebRTC  │ │   UDP   │  │                      │
│                      │  │ (Video) │ │  (IMU)  │  │                      │
│                      │  └─────────┘ └─────────┘  │                      │
│                      └─────────────┬─────────────┘                      │
│                                    │                                     │
│  ┌──────────────────────────────────────────────────────────────────┐   │
│  │                         PC (Ubuntu/Windows)                       │   │
│  │  ┌──────────────────────────────────────────────────────────┐   │   │
│  │  │                   Data Receiver                           │   │   │
│  │  │  ┌────────────┐  ┌────────────┐  ┌────────────┐          │   │   │
│  │  │  │   Video    │  │    IMU     │  │    Time    │          │   │   │
│  │  │  │  Decoder   │  │   Buffer   │  │  Aligner   │          │   │   │
│  │  │  └──────┬─────┘  └──────┬─────┘  └──────┬─────┘          │   │   │
│  │  │         └───────────────┼───────────────┘                 │   │   │
│  │  └─────────────────────────┼─────────────────────────────────┘   │   │
│  │                            ▼                                      │   │
│  │  ┌──────────────────────────────────────────────────────────┐   │   │
│  │  │                   VI-SLAM Engine                          │   │   │
│  │  │  ┌──────────────────────────────────────────────────┐    │   │   │
│  │  │  │              Framework Adapter                    │    │   │   │
│  │  │  │  ┌──────────┐ ┌──────────┐ ┌──────────┐         │    │   │   │
│  │  │  │  │VINS-Mono │ │ OpenVINS │ │ORB-SLAM3 │         │    │   │   │
│  │  │  │  └──────────┘ └──────────┘ └──────────┘         │    │   │   │
│  │  │  └──────────────────────────────────────────────────┘    │   │   │
│  │  └──────────────────────────────────────────────────────────┘   │   │
│  │                            │                                      │   │
│  │                            ▼                                      │   │
│  │  ┌──────────────────────────────────────────────────────────┐   │   │
│  │  │                   Output Manager                          │   │   │
│  │  │  ┌────────────┐  ┌────────────┐  ┌────────────┐          │   │   │
│  │  │  │ Pose API   │  │ Visualizer │  │  Exporter  │          │   │   │
│  │  │  │ (ROS/ZMQ)  │  │  (RViz)    │  │ (TUM/PLY)  │          │   │   │
│  │  │  └────────────┘  └────────────┘  └────────────┘          │   │   │
│  │  └──────────────────────────────────────────────────────────┘   │   │
│  └──────────────────────────────────────────────────────────────────┘   │
│                                                                          │
└─────────────────────────────────────────────────────────────────────────┘
```

### 10.2 컴포넌트 다이어그램

```
┌─────────────────────────────────────────────────────────────────────────┐
│                          Component Diagram                               │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                          │
│  ┌─────────────────────────────────────────────────────────────────┐    │
│  │                     Android App Components                       │    │
│  │                                                                  │    │
│  │   ┌─────────────┐     ┌─────────────┐     ┌─────────────┐      │    │
│  │   │ MainActivity│────▶│   Camera    │     │     IMU     │      │    │
│  │   │             │     │   Service   │     │   Service   │      │    │
│  │   └─────────────┘     └──────┬──────┘     └──────┬──────┘      │    │
│  │                              │                   │              │    │
│  │   ┌─────────────┐           ▼                   ▼              │    │
│  │   │  Settings   │     ┌─────────────────────────────────┐      │    │
│  │   │  Fragment   │────▶│      Timestamp Synchronizer     │      │    │
│  │   └─────────────┘     └──────────────┬──────────────────┘      │    │
│  │                                       │                         │    │
│  │   ┌─────────────┐                    ▼                         │    │
│  │   │ Calibration │     ┌─────────────────────────────────┐      │    │
│  │   │  Fragment   │────▶│         Data Manager            │      │    │
│  │   └─────────────┘     │  ┌─────────┐  ┌─────────────┐  │      │    │
│  │                       │  │ Recorder│  │  Streamer   │  │      │    │
│  │                       │  └─────────┘  └─────────────┘  │      │    │
│  │                       └─────────────────────────────────┘      │    │
│  └─────────────────────────────────────────────────────────────────┘    │
│                                                                          │
│  ┌─────────────────────────────────────────────────────────────────┐    │
│  │                      PC Client Components                        │    │
│  │                                                                  │    │
│  │   ┌─────────────┐     ┌─────────────┐     ┌─────────────┐      │    │
│  │   │    Main     │────▶│   WebRTC    │     │     UDP     │      │    │
│  │   │  Controller │     │   Client    │     │   Receiver  │      │    │
│  │   └─────────────┘     └──────┬──────┘     └──────┬──────┘      │    │
│  │                              │                   │              │    │
│  │   ┌─────────────┐           ▼                   ▼              │    │
│  │   │   Config    │     ┌─────────────────────────────────┐      │    │
│  │   │   Manager   │────▶│         Data Synchronizer       │      │    │
│  │   └─────────────┘     └──────────────┬──────────────────┘      │    │
│  │                                       │                         │    │
│  │                                       ▼                         │    │
│  │                       ┌─────────────────────────────────┐      │    │
│  │                       │      SLAM Framework Adapter     │      │    │
│  │                       │  ┌────────┐ ┌────────┐         │      │    │
│  │                       │  │ VINS   │ │OpenVINS│  ...    │      │    │
│  │                       │  └────────┘ └────────┘         │      │    │
│  │                       └──────────────┬──────────────────┘      │    │
│  │                                       │                         │    │
│  │                                       ▼                         │    │
│  │                       ┌─────────────────────────────────┐      │    │
│  │                       │         Output Manager          │      │    │
│  │                       │  ┌────────┐ ┌────────┐ ┌─────┐ │      │    │
│  │                       │  │ROS Pub │ │Visualiz│ │Export│ │      │    │
│  │                       │  └────────┘ └────────┘ └─────┘ │      │    │
│  │                       └─────────────────────────────────┘      │    │
│  └─────────────────────────────────────────────────────────────────┘    │
│                                                                          │
└─────────────────────────────────────────────────────────────────────────┘
```

### 10.3 시퀀스 다이어그램: 실시간 SLAM

```
┌─────┐          ┌─────────┐    ┌──────────┐    ┌──────┐    ┌──────────┐
│User │          │   App   │    │ Network  │    │  PC  │    │ VI-SLAM  │
└──┬──┘          └────┬────┘    └────┬─────┘    └──┬───┘    └────┬─────┘
   │                  │              │             │              │
   │  Start Session   │              │             │              │
   │─────────────────▶│              │             │              │
   │                  │              │             │              │
   │                  │ Connect      │             │              │
   │                  │─────────────▶│             │              │
   │                  │              │  Accept     │              │
   │                  │              │────────────▶│              │
   │                  │  Connected   │             │              │
   │                  │◀─────────────│             │              │
   │                  │              │             │              │
   │                  │────┐ Start   │             │              │
   │                  │    │ Camera  │             │              │
   │                  │◀───┘ & IMU   │             │              │
   │                  │              │             │              │
   │        ┌─────────┴──────────────┴─────────────┴──────────────┴─────┐
   │        │                         Loop                              │
   │        │ ┌───────────────────────────────────────────────────────┐ │
   │        │ │                                                       │ │
   │        │ │  │ Frame + IMU │             │              │         │ │
   │        │ │  │────────────▶│ Stream      │              │         │ │
   │        │ │  │             │────────────▶│              │         │ │
   │        │ │  │             │             │  Sync &      │         │ │
   │        │ │  │             │             │  Process     │         │ │
   │        │ │  │             │             │─────────────▶│         │ │
   │        │ │  │             │             │              │         │ │
   │        │ │  │             │             │  Pose        │         │ │
   │        │ │  │             │             │◀─────────────│         │ │
   │        │ │  │             │             │              │         │ │
   │        │ │  │             │   Pose      │              │         │ │
   │        │ │  │◀────────────│◀────────────│              │         │ │
   │        │ │  │             │             │              │         │ │
   │        │ └───────────────────────────────────────────────────────┘ │
   │        │                      [30 Hz]                              │
   │        └───────────────────────────────────────────────────────────┘
   │                  │              │             │              │
   │  Stop Session    │              │             │              │
   │─────────────────▶│              │             │              │
   │                  │ Disconnect   │             │              │
   │                  │─────────────▶│             │              │
   │                  │              │             │              │
   │  Session Stats   │              │             │              │
   │◀─────────────────│              │             │              │
   │                  │              │             │              │
```

---

## 11. 제약 조건 및 가정

### 11.1 기술적 제약 조건

| ID | 제약 조건 | 영향 | 대응 방안 |
|----|----------|------|----------|
| C1 | Camera2 API 지원 필요 | 구형 기기 미지원 | 최소 Android 8.0으로 제한 |
| C2 | 네트워크 지연 존재 | 실시간성 제한 | 버퍼링 및 예측 알고리즘 |
| C3 | IMU 샘플링 제한 (기기별) | 일부 기기 200Hz 미달 | 최소 100Hz로 대응, 보간 |
| C4 | 배터리 소모 | 장시간 사용 제한 | 절전 모드, 경고 표시 |
| C5 | Rolling Shutter | 빠른 움직임 시 왜곡 | VINS-Mono RS 모델 사용 |

### 11.2 비즈니스 제약 조건

| ID | 제약 조건 | 영향 | 대응 방안 |
|----|----------|------|----------|
| C6 | 오픈소스 라이선스 | 상용화 제한 (GPLv3) | Basalt (BSD) 옵션 제공 |
| C7 | 1인 개발 리소스 | 개발 속도 제한 | 핵심 기능 우선 개발 |
| C8 | 테스트 기기 제한 | 호환성 검증 제한 | 커뮤니티 협력 |

### 11.3 가정 사항

| ID | 가정 | 리스크 | 검증 방법 |
|----|------|--------|----------|
| A1 | 5GHz WiFi 환경 가용 | 네트워크 성능 저하 | 다양한 환경 테스트 |
| A2 | 사용자가 기본 개발 지식 보유 | 사용성 문제 | 상세 문서화 |
| A3 | 정적 환경에서 주로 사용 | 동적 환경 성능 저하 | 사용 시나리오 명시 |
| A4 | 충분한 조명 환경 | 저조도 성능 저하 | 권장 환경 명시 |

---

## 12. 로드맵 및 마일스톤

### 12.1 전체 로드맵

```
2026
Q1                    Q2                    Q3                    Q4
├─────────────────────┼─────────────────────┼─────────────────────┼─────────
│                     │                     │                     │
│ ┌─────────────────┐ │ ┌─────────────────┐ │ ┌─────────────────┐ │
│ │    Phase 1      │ │ │    Phase 2      │ │ │    Phase 3      │ │
│ │    MVP          │ │ │   Real-time     │ │ │   Expansion     │ │
│ │                 │ │ │                 │ │ │                 │ │
│ │ • Android 앱    │ │ │ • 실시간 스트리밍│ │ │ • iOS 앱        │ │
│ │ • PC 클라이언트 │ │ │ • 다중 프레임워크│ │ │ • 자동 캘리브   │ │
│ │ • VINS-Mono     │ │ │ • 시각화        │ │ │ • 클라우드 연동 │ │
│ │ • 오프라인 처리 │ │ │ • ROS 연동      │ │ │ • SDK/플러그인  │ │
│ └─────────────────┘ │ └─────────────────┘ │ └─────────────────┘ │
│                     │                     │                     │
│ M1 ─────────────────│ M2 ─────────────────│ M3 ────────────────│ M4
│ MVP 출시            │ v1.0 출시           │ v1.5 출시          │ v2.0 출시
│                     │                     │                     │
```

### 12.2 Phase 1: MVP (Q1 2026)

**목표**: 기본 데이터 수집 및 오프라인 SLAM 처리

| 마일스톤 | 기간 | 산출물 |
|---------|------|--------|
| M1.1 | Week 1-2 | Android 앱 프로토타입 (카메라/IMU 캡처) |
| M1.2 | Week 3-4 | 로컬 저장 기능, 데이터 형식 정의 |
| M1.3 | Week 5-6 | PC 데이터 로더, VINS-Mono 연동 |
| M1.4 | Week 7-8 | 오프라인 처리 파이프라인, 결과 시각화 |
| M1.5 | Week 9-10 | 테스트, 문서화, MVP 릴리스 |

**주요 기능**:
- FR1.1-1.4: 카메라/IMU 캡처, 로컬 저장
- FR3.4: VINS-Mono 연동
- FR6.1, FR6.4: EuRoC/CSV 형식 지원
- FR9.1: 궤적 내보내기

### 12.3 Phase 2: Real-time (Q2 2026)

**목표**: 실시간 스트리밍 및 다중 프레임워크 지원

| 마일스톤 | 기간 | 산출물 |
|---------|------|--------|
| M2.1 | Week 1-3 | WebRTC 비디오 스트리밍 |
| M2.2 | Week 4-5 | UDP IMU 스트리밍, 동기화 |
| M2.3 | Week 6-7 | OpenVINS, ORB-SLAM3 연동 |
| M2.4 | Week 8-9 | ROS 연동, 실시간 시각화 |
| M2.5 | Week 10-12 | 성능 최적화, v1.0 릴리스 |

**주요 기능**:
- FR1.5, FR4.1-4.4: 실시간 스트리밍
- FR3.4 확장: OpenVINS, ORB-SLAM3
- FR3.7: ROS 토픽 퍼블리시
- FR3.5: 실시간 시각화

### 12.4 Phase 3: Expansion (Q3-Q4 2026)

**목표**: 플랫폼 확장 및 고급 기능

| 마일스톤 | 기간 | 산출물 |
|---------|------|--------|
| M3.1 | Q3 Week 1-6 | iOS 앱 개발 |
| M3.2 | Q3 Week 7-12 | 자동 캘리브레이션 도구 |
| M3.3 | Q4 Week 1-6 | Unity/Unreal SDK |
| M3.4 | Q4 Week 7-12 | 클라우드 처리 옵션, v2.0 릴리스 |

**주요 기능**:
- FR2.x: iOS 앱 전체
- FR8.5: 자동 캘리브레이션
- 새로운 요구사항: SDK, 클라우드

### 12.5 릴리스 계획

| 버전 | 날짜 | 주요 내용 |
|------|------|----------|
| v0.1.0-alpha | 2026-02 | 내부 테스트용 MVP |
| v0.5.0-beta | 2026-03 | 공개 베타 (Android + 오프라인) |
| v1.0.0 | 2026-06 | 첫 정식 릴리스 (실시간 + 다중 프레임워크) |
| v1.5.0 | 2026-09 | iOS 추가, 자동 캘리브레이션 |
| v2.0.0 | 2026-12 | SDK, 클라우드 연동 |

---

## 13. 리스크 분석

### 13.1 리스크 매트릭스

```
         영향도
    높음 │  R3      R1
         │
    중간 │  R5   R2   R4
         │
    낮음 │  R6
         └──────────────────
           낮음   중간   높음
                발생 가능성
```

### 13.2 리스크 상세

| ID | 리스크 | 발생 가능성 | 영향도 | 대응 전략 |
|----|--------|------------|--------|----------|
| **R1** | 스마트폰 기기별 호환성 문제 | 높음 | 높음 | 호환 기기 목록 관리, 커뮤니티 피드백 |
| **R2** | 네트워크 지연으로 실시간성 미달 | 중간 | 중간 | 버퍼링 최적화, USB 테더링 대안 |
| **R3** | SLAM 프레임워크 업데이트 호환성 | 중간 | 높음 | 버전 고정, 어댑터 패턴 |
| **R4** | 센서 캘리브레이션 정확도 부족 | 높음 | 중간 | 자동 캘리브레이션 개발, 가이드 강화 |
| **R5** | 개발 일정 지연 | 중간 | 중간 | 핵심 기능 우선, 범위 조정 |
| **R6** | 경쟁 제품 출현 | 낮음 | 낮음 | 차별화 기능 강화, 커뮤니티 구축 |

### 13.3 리스크 완화 계획

#### R1: 기기 호환성 (높음/높음)

```
완화 전략:
1. 공식 지원 기기 목록 관리 및 공개
2. Camera2 API 레벨 검사 로직 구현
3. 커뮤니티 기반 호환성 리포트 시스템
4. 비호환 기기에 대한 명확한 경고 메시지

대응 계획:
- 발생 시: 해당 기기 분석 → 워크어라운드 또는 비지원 목록
- 예산: 테스트 기기 구매 예산 확보
```

#### R4: 캘리브레이션 정확도 (높음/중간)

```
완화 전략:
1. 단계별 캘리브레이션 가이드 제공
2. 캘리브레이션 품질 지표 실시간 표시
3. 사전 설정된 기기별 기본값 제공
4. Phase 2에서 자동 캘리브레이션 구현

대응 계획:
- 발생 시: 트러블슈팅 가이드 제공
- 장기: 온라인 캘리브레이션 강화 (VINS estimate_td)
```

---

## 14. 부록

### 14.1 용어집

| 용어 | 정의 |
|------|------|
| **VI-SLAM** | Visual-Inertial SLAM. 카메라와 IMU를 결합한 SLAM |
| **IMU** | Inertial Measurement Unit. 가속도계+자이로스코프 |
| **6DoF** | 6 Degrees of Freedom. 위치(x,y,z) + 자세(roll,pitch,yaw) |
| **ATE** | Absolute Trajectory Error. 절대 궤적 오차 |
| **RMSE** | Root Mean Square Error. 평균제곱근오차 |
| **Extrinsic** | 센서 간 상대적 위치/자세 변환 |
| **Intrinsic** | 센서 내부 파라미터 (초점거리, 왜곡계수 등) |
| **Rolling Shutter** | 행 단위 순차 노출 방식 |
| **Loop Closing** | 이전 방문 장소 인식으로 오차 보정 |
| **Tightly Coupled** | Visual과 Inertial을 단일 최적화에서 처리 |

### 14.2 참조 문서

| 문서 | 위치 |
|------|------|
| VI-SLAM Overview | `docs/reference/01_vi_slam_overview.md` |
| Android Camera2 API | `docs/reference/06_android_camera2_api.md` |
| Streaming Protocols | `docs/reference/03_streaming_protocols.md` |
| App Development Guide | `docs/reference/11_app_development_guide.md` |
| Framework Comparison | `docs/reference/05_vislam_frameworks.md` |
| Comprehensive Analysis | `docs/comprehensive_analysis.md` |

### 14.3 변경 이력

| 버전 | 날짜 | 변경 내용 | 작성자 |
|------|------|----------|--------|
| 1.0.0 | 2026-01-20 | 초기 작성 | VI-SLAM Team |

---

## 승인

| 역할 | 이름 | 서명 | 날짜 |
|------|------|------|------|
| Product Owner | | | |
| Tech Lead | | | |
| QA Lead | | | |

---

*본 문서는 VI-SLAM 프로젝트의 제품 요구사항을 정의합니다.*
*문서 생성일: 2026-01-20*
*버전: 1.0.0*
