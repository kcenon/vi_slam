# 소프트웨어 요구사항 명세서 (Software Requirements Specification, SRS)
# VI-SLAM: 스마트폰 비주얼-관성 SLAM 시스템

---

| 항목 | 값 |
|------|-------|
| 문서 ID | SRS-VISLAM-001 |
| 원본 PRD | PRD-VISLAM-001 (PRD.md) |
| 버전 | 1.0.0 |
| 상태 | Draft (초안) |
| 작성일 | 2026-01-24 |
| 작성자 | VI-SLAM 프로젝트 팀 |

---

## 목차

1. [서론](#1-서론)
2. [전체 설명](#2-전체-설명)
3. [시스템 기능](#3-시스템-기능)
4. [외부 인터페이스 요구사항](#4-외부-인터페이스-요구사항)
5. [비기능적 요구사항](#5-비기능적-요구사항)
6. [데이터 요구사항](#6-데이터-요구사항)
7. [추적성 매트릭스](#7-추적성-매트릭스)
8. [부록](#8-부록)

---

## 1. 서론

### 1.1 목적 (Purpose)

이 소프트웨어 요구사항 명세서(SRS)는 VI-SLAM 시스템 요구사항에 대한 포괄적인 설명을 제공합니다. 이 문서는 개발팀, 테스터 및 이해관계자가 시스템의 상세한 기능적/비기능적 요구사항을 이해하기 위한 주요 참조 자료로 사용됩니다.

이 문서는 제품 요구사항 문서(PRD)의 상위 수준 요구사항을 상세하고 테스트 가능한 명세로 분해하며, 완전한 유스케이스, 인터페이스 정의 및 추적성을 포함합니다.

### 1.2 범위 (Scope)

VI-SLAM 시스템은 다음을 포함합니다:

- **안드로이드 애플리케이션**: 스마트폰 센서에서 카메라 프레임 및 IMU 데이터 캡처
- **iOS 애플리케이션** (2단계): Apple 기기용 유사 기능
- **PC 클라이언트**: VI-SLAM 프레임워크를 사용하여 데이터 수신, 동기화 및 처리
- **통신 계층**: WebRTC 및 UDP 프로토콜을 통한 실시간 스트리밍
- **VI-SLAM 엔진**: 다중 SLAM 프레임워크 통합 (VINS-Mono, OpenVINS, ORB-SLAM3, Basalt)
- **출력 시스템**: 궤적 내보내기, 포인트 클라우드 생성 및 실시간 포즈 API

### 1.3 정의 및 약어

| 용어 | 정의 |
|------|------|
| VI-SLAM | Visual-Inertial Simultaneous Localization and Mapping (비주얼-관성 동시 위치추정 및 지도작성) |
| IMU | Inertial Measurement Unit (관성 측정 장치: 가속도계 + 자이로스코프) |
| 6DoF | Six Degrees of Freedom (6자유도: 위치 + 방향) |
| ATE | Absolute Trajectory Error (절대 궤적 오차) |
| RMSE | Root Mean Square Error (평균 제곱근 오차) |
| FPS | Frames Per Second (초당 프레임 수) |
| WebRTC | Web Real-Time Communication (웹 실시간 통신 프로토콜) |
| ROS | Robot Operating System (로봇 운영 체제) |
| EuRoC | European Robotics Challenge (벤치마크 데이터셋 형식) |
| TUM | Technical University of Munich (궤적 형식) |
| Extrinsic | 센서 간 상대적 위치/방향 (외부 파라미터) |
| Intrinsic | 카메라 내부 파라미터 (초점 거리, 왜곡) |
| Rolling Shutter | 순차적 행별 이미지 캡처 방식 |
| Loop Closing | 재방문 위치 인식을 통한 오류 보정 |

### 1.4 참조 문서

| 문서 | 설명 |
|------|------|
| PRD.md | 제품 요구사항 문서 |
| 01_vi_slam_overview.md | VI-SLAM 기술 개요 |
| 03_streaming_protocols.md | 스트리밍 프로토콜 분석 |
| 05_vislam_frameworks.md | 프레임워크 비교 |
| 06_android_camera2_api.md | Android Camera2 API 참조 |
| 09_timestamp_synchronization.md | 타임스탬프 동기화 기술 |
| 19_calibration_practical_guide.md | 캘리브레이션 절차 |

---

## 2. 전체 설명

### 2.1 제품 관점 (Product Perspective)

VI-SLAM은 일반 스마트폰을 전문 비주얼-관성 센서 플랫폼으로 변환하는 독립형 시스템입니다. 시스템은 클라이언트-서버 아키텍처로 운영됩니다:

- 스마트폰은 센서 허브 및 데이터 송신기 역할
- PC는 VI-SLAM 알고리즘을 실행하는 처리 서버 역할
- 네트워크 연결(WiFi/USB 테더링)이 두 구성 요소를 연결

```
+------------------+       네트워크         +------------------+
|   스마트폰        |   (WebRTC/UDP)       |       PC         |
|   - 카메라        | ===================> |   - VI-SLAM      |
|   - IMU          |                      |   - 시각화        |
|   - 스트리머      |                      |   - ROS 브릿지    |
+------------------+                      +------------------+
```

### 2.2 제품 기능 요약 (Product Functions Summary)

| 기능 카테고리 | 주요 기능 |
|--------------|----------|
| **데이터 수집** | 카메라 캡처 (30Hz), IMU 캡처 (200Hz), 동기화된 타임스탬프 |
| **데이터 저장** | 로컬 녹화, EuRoC/TUM 형식 내보내기, 메타데이터 생성 |
| **실시간 스트리밍** | WebRTC 비디오, UDP IMU, 저지연 전송 (<100ms) |
| **SLAM 처리** | 다중 프레임워크 지원, 6DoF 포즈 추정, 맵 생성 |
| **캘리브레이션** | 카메라 내부 파라미터, 카메라-IMU 외부 파라미터, 시간 오프셋 추정 |
| **출력** | 궤적 내보내기, 포인트 클라우드, ROS 토픽, 실시간 API |

### 2.3 사용자 클래스 및 특성 (User Classes and Characteristics)

| 사용자 클래스 | 특성 | 주요 유스케이스 |
|--------------|------|----------------|
| **AR/VR 개발자** | Unity/Unreal 경험, 기본 SLAM 지식 | AR 애플리케이션용 실시간 포즈 |
| **로보틱스 연구원** | ROS 전문성, 알고리즘 개발 | 데이터 수집, 알고리즘 테스트 |
| **매핑 엔지니어** | 3D 모델링 배경, 데이터 처리 | 오프라인 SLAM, 맵 생성 |
| **실내 측위 개발자** | 위치 서비스 경험 | 포즈 추정 통합 |

### 2.4 운영 환경 (Operating Environment)

#### 2.4.1 스마트폰 환경

| 구성요소 | 최소 | 권장 |
|---------|------|------|
| Android 버전 | 8.0 (API 26) | 11.0+ (API 30+) |
| Camera2 API 수준 | HARDWARE_LEVEL_LIMITED | HARDWARE_LEVEL_FULL |
| RAM | 2 GB | 4 GB+ |
| 저장공간 | 1 GB 여유 | 10 GB+ 여유 |
| 센서 | 가속도계, 자이로스코프 | + 자력계, 기압계 |

#### 2.4.2 PC 환경

| 구성요소 | 최소 | 권장 |
|---------|------|------|
| 운영체제 | Ubuntu 18.04 | Ubuntu 20.04/22.04 |
| CPU | Intel i5 / AMD Ryzen 5 | Intel i7 / AMD Ryzen 7 |
| RAM | 8 GB | 16 GB+ |
| GPU | 내장 그래픽 | NVIDIA GTX 1060+ |
| 저장공간 | 50 GB | 200 GB+ SSD |

#### 2.4.3 네트워크 환경

| 구성요소 | 최소 | 권장 |
|---------|------|------|
| 연결 유형 | 2.4 GHz WiFi | 5 GHz WiFi / USB 테더링 |
| 대역폭 | 5 Mbps | 20 Mbps+ |
| 지연 시간 | < 50 ms | < 20 ms |

### 2.5 설계 및 구현 제약조건 (Design and Implementation Constraints)

| 제약조건 ID | 설명 | 영향 |
|-------------|------|------|
| DC-001 | 전체 기능을 위해 Camera2 API HARDWARE_LEVEL_FULL 필요 | 호환 기기 제한 |
| DC-002 | IMU 샘플링 속도 기기 의존적 (일부 < 200Hz) | 보간 필요 가능 |
| DC-003 | 롤링 셔터 카메라는 보정 필요 | 빠른 움직임 정확도 영향 |
| DC-004 | 네트워크 지연이 실시간 성능에 영향 | 버퍼링/예측 필요 |
| DC-005 | 오픈소스 라이선스 (일부 프레임워크 GPLv3) | 상업적 사용 제한 |
| DC-006 | 배터리 소모가 작동 시간 제한 | 전원 관리 필요 |

---

## 3. 시스템 기능

### SF-001: 카메라 프레임 캡처 (Camera Frame Capture)

**출처**: FR1.1 (PRD)
**우선순위**: P0
**설명**: Camera2 API를 사용하여 정확한 센서 타임스탬프와 함께 스마트폰 후면 카메라에서 프레임 캡처

#### 3.1.1 유스케이스

##### UC-001: 표준 카메라 캡처 (Standard Camera Capture)

- **행위자 (Actor)**: Android 애플리케이션
- **사전조건 (Preconditions)**:
  1. 기기가 Camera2 API HARDWARE_LEVEL_LIMITED 이상 지원
  2. 카메라 권한 부여됨
  3. 카메라가 다른 애플리케이션에서 사용 중이 아님
- **기본 흐름 (Main Flow)**:
  1. 애플리케이션이 지정된 파라미터로 Camera2 세션 초기화
  2. 시스템이 후면 카메라 기기 열기
  3. 시스템이 YUV420 또는 JPEG 형식용 ImageReader 구성
  4. 시스템이 대상 서피스로 캡처 세션 생성
  5. 시스템이 반복 캡처 요청 시작
  6. 각 프레임에 대해:
     a. 시스템이 이미지 버퍼 캡처
     b. 시스템이 SENSOR_TIMESTAMP 추출
     c. 시스템이 프레임과 타임스탬프 패키징
     d. 시스템이 데이터 관리자에 전달
  7. 시스템이 목표 FPS로 캡처 유지
- **대안 흐름 (Alternative Flows)**:
  - 2a. 카메라 기기 사용 불가:
    - 시스템이 오류 메시지 표시
    - 시스템이 1초 후 재시도 시도 (최대 3회)
    - 시스템이 실패를 사용자에게 알림
  - 6a. 프레임 드롭 감지:
    - 시스템이 프레임 드롭 이벤트 로그
    - 시스템이 중단 없이 캡처 계속
    - 시스템이 프레임 드롭 통계 업데이트
- **예외 흐름 (Exception Flows)**:
  - E1. 캡처 중 카메라 연결 해제:
    - 시스템이 카메라 리소스 해제
    - 시스템이 사용자에게 알림
    - 시스템이 재연결 옵션 제공
  - E2. 메모리 압박 감지:
    - 시스템이 버퍼 크기 감소
    - 시스템이 일시적으로 해상도 감소 가능
- **사후조건 (Postconditions)**:
  1. 지정된 FPS로 프레임 캡처 (5% 허용 오차 이내)
  2. 각 프레임에 나노초 정밀도 타임스탬프
  3. 프레임 메타데이터 (노출, ISO) 사용 가능

#### 3.1.2 인수 기준 (Acceptance Criteria)

- [ ] AC-001.1: 프레임 캡처 속도 30 FPS 유지, < 1% 드롭률
- [ ] AC-001.2: 타임스탬프 정확도 실제 캡처 시간 대비 1ms 이내
- [ ] AC-001.3: 720p 및 1080p 해상도 지원
- [ ] AC-001.4: 1시간 연속 작동 후 메모리 누수 없음
- [ ] AC-001.5: 카메라 초기화 2초 이내 완료
- [ ] AC-001.6: 카메라 인터럽트 (전화 등) 우아한 처리

#### 3.1.3 의존성 (Dependencies)

- 의존: 없음 (기본 기능)
- 차단: SF-003 (타임스탬프 동기화), SF-005 (실시간 스트리밍)

---

### SF-002: IMU 데이터 캡처 (IMU Data Capture)

**출처**: FR1.2 (PRD)
**우선순위**: P0
**설명**: Android SensorManager를 사용하여 고주파수로 가속도계 및 자이로스코프 데이터 캡처

#### 3.2.1 유스케이스

##### UC-002: 고주파수 IMU 샘플링 (High-Frequency IMU Sampling)

- **행위자**: Android 애플리케이션
- **사전조건**:
  1. 기기에 가속도계 및 자이로스코프 센서 있음
  2. 센서 권한 부여됨 (Android 버전에 따라 필요시)
- **기본 흐름**:
  1. 애플리케이션이 SENSOR_DELAY_FASTEST로 센서 리스너 등록
  2. 시스템이 사용 가능한 센서 유형 조회 (보정/미보정)
  3. 시스템이 IMU 데이터용 순환 버퍼 초기화
  4. 각 센서 이벤트에 대해:
     a. 시스템이 가속도 (ax, ay, az) m/s^2로 추출
     b. 시스템이 각속도 (gx, gy, gz) rad/s로 추출
     c. 시스템이 센서 타임스탬프 (나노초) 기록
     d. 시스템이 샘플을 순환 버퍼에 추가
     e. 시스템이 데이터 관리자에 새 데이터 알림
  5. 시스템이 목표 주파수로 샘플링 유지
- **대안 흐름**:
  - 1a. SENSOR_DELAY_FASTEST가 목표 속도 달성 못함:
    - 시스템이 실제 달성 속도 로그
    - 시스템이 최상의 가용 속도로 계속
    - 시스템이 속도 < 100Hz시 사용자에게 경고
  - 4a. 버퍼 오버플로우 임박:
    - 시스템이 메모리 가용시 버퍼 확장
    - 시스템이 필요시 가장 오래된 샘플 삭제
    - 시스템이 오버플로우 이벤트 로그
- **예외 흐름**:
  - E1. 센서 연결 해제:
    - 시스템이 재연결 시도
    - 시스템이 3회 실패 후 사용자에게 알림
  - E2. 센서가 잘못된 데이터 반환:
    - 시스템이 데이터 범위 검증
    - 시스템이 잘못된 샘플 폐기
    - 시스템이 이상 로그
- **사후조건**:
  1. IMU 샘플이 목표 속도의 >= 95%로 사용 가능
  2. 각 샘플에 나노초 정밀도 타임스탬프
  3. 타임스탬프가 단조 증가 보장

#### 3.2.2 인수 기준

- [ ] AC-002.1: 호환 기기에서 >= 200Hz 샘플링 속도 달성
- [ ] AC-002.2: 샘플 손실률 < 0.1%
- [ ] AC-002.3: 타임스탬프 단조성 보장
- [ ] AC-002.4: 보정 및 미보정 센서 유형 모두 지원
- [ ] AC-002.5: 순환 버퍼가 500Hz에서 5초 데이터 처리
- [ ] AC-002.6: IMU 캡처용 CPU 사용량 < 5%

#### 3.2.3 의존성

- 의존: 없음 (기본 기능)
- 차단: SF-003 (타임스탬프 동기화), SF-005 (실시간 스트리밍)

---

### SF-003: 타임스탬프 동기화 (Timestamp Synchronization)

**출처**: FR1.3, FR5.1, FR5.2 (PRD)
**우선순위**: P0
**설명**: 카메라와 IMU 타임스탬프를 통합 타임라인으로 통합하고 프레임 타임스탬프에 대한 IMU 보간 제공

#### 3.3.1 유스케이스

##### UC-003: 카메라-IMU 시간 정렬 (Camera-IMU Time Alignment)

- **행위자**: 데이터 관리자
- **사전조건**:
  1. 카메라 캡처 활성 (SF-001)
  2. IMU 캡처 활성 (SF-002)
  3. 시스템 클럭 안정
- **기본 흐름**:
  1. 데이터 관리자가 타임스탬프 T_cam과 함께 카메라 프레임 수신
  2. 데이터 관리자가 T_cam 주변 샘플에 대해 IMU 버퍼 조회
  3. 시스템이 IMU 샘플 식별: T_imu_before <= T_cam <= T_imu_after
  4. 시스템이 T_cam에서 IMU에 대해 선형 보간 수행:
     - ratio = (T_cam - T_imu_before) / (T_imu_after - T_imu_before)
     - acc_interp = acc_before + ratio * (acc_after - acc_before)
     - gyro_interp = gyro_before + ratio * (gyro_after - gyro_before)
  5. 시스템이 보간된 IMU를 프레임과 연관
  6. 시스템이 연속 프레임 사이의 IMU 샘플도 제공
  7. 시스템이 다운스트림 처리를 위해 동기화된 데이터 패키징
- **대안 흐름**:
  - 3a. 타임스탬프에 사용 가능한 IMU 샘플 없음:
    - 시스템이 프레임을 IMU 불가용으로 표시
    - 시스템이 동기화 갭 로그
  - 4a. 시간 갭이 너무 큼 (> 50ms):
    - 시스템이 잠재적 동기화 문제 플래그
    - 시스템이 보간 대신 최근접 이웃 사용
- **예외 흐름**:
  - E1. 클럭 불연속성 감지:
    - 시스템이 시간 참조 재보정
    - 시스템이 불연속성 이벤트 로그
- **사후조건**:
  1. 각 프레임에 연관된 IMU 데이터 있음
  2. 동기화 정확도 1ms 이내

#### 3.3.2 인수 기준

- [ ] AC-003.1: 타임스탬프 정렬 정확도 < 1ms
- [ ] AC-003.2: IMU 보간 계산 효율적 (프레임당 < 1ms)
- [ ] AC-003.3: 가변 IMU 샘플링 속도 우아하게 처리
- [ ] AC-003.4: 클럭 동기화 문제 감지 및 보고
- [ ] AC-003.5: 30분 세션 동안 동기화 유지

#### 3.3.3 의존성

- 의존: SF-001 (카메라 캡처), SF-002 (IMU 캡처)
- 차단: SF-007 (데이터 저장), SF-005 (실시간 스트리밍)

---

### SF-004: 로컬 데이터 저장 (Local Data Storage)

**출처**: FR1.4 (PRD)
**우선순위**: P0
**설명**: 적절한 형식과 메타데이터로 스마트폰에 비디오 및 IMU 데이터 로컬 저장

#### 3.4.1 유스케이스

##### UC-004: 녹화 세션 (Recording Session)

- **행위자**: 사용자, 데이터 관리자
- **사전조건**:
  1. 충분한 저장 공간 사용 가능 (> 500MB 여유)
  2. 카메라 및 IMU 캡처 초기화됨
  3. 녹화 디렉토리 접근 가능
- **기본 흐름**:
  1. 사용자가 "녹화" 버튼 탭
  2. 시스템이 타임스탬프가 지정된 세션 디렉토리 생성
  3. 시스템이 비디오 인코더 (H.264) 초기화
  4. 시스템이 헤더와 함께 IMU CSV 파일 생성
  5. 시스템이 녹화 시작:
     a. 비디오 프레임 인코딩 후 MP4에 기록
     b. IMU 샘플 실시간으로 CSV에 기록
     c. 시스템이 녹화 통계 표시 (프레임, 지속시간)
  6. 사용자가 "정지" 버튼 탭
  7. 시스템이 비디오 파일 마무리
  8. 시스템이 IMU 파일 닫기
  9. 시스템이 metadata.json 생성
  10. 시스템이 데이터 무결성 확인 (체크섬)
  11. 시스템이 세션 요약 표시
- **대안 흐름**:
  - 5a. 저장 공간 부족:
    - 시스템이 200MB 남았을 때 경고
    - 시스템이 50MB 남았을 때 자동 정지
  - 7a. 비디오 인코딩 오류:
    - 시스템이 폴백으로 원시 프레임 저장
    - 시스템이 인코딩 실패 로그
- **예외 흐름**:
  - E1. 녹화 중 앱 크래시:
    - 재시작시, 시스템이 부분 데이터 복구
    - 시스템이 세션을 불완전으로 표시
  - E2. 저장소 쓰기 실패:
    - 시스템이 대체 저장 위치 시도
    - 시스템이 실패를 사용자에게 알림
- **사후조건**:
  1. 완전한 세션 데이터가 저장소에 저장됨
  2. 모든 파일이 무결성 검증 통과
  3. 메타데이터가 세션을 정확히 설명

#### 3.4.2 인수 기준

- [ ] AC-004.1: 비디오가 H.264 MP4 형식으로 저장
- [ ] AC-004.2: IMU가 나노초 타임스탬프와 함께 CSV로 저장
- [ ] AC-004.3: 메타데이터 JSON에 기기 정보, 캘리브레이션, 통계 포함
- [ ] AC-004.4: 녹화 중 프레임 드롭률 < 1%
- [ ] AC-004.5: 최대 60분 세션 지원
- [ ] AC-004.6: 예기치 않은 종료 후 데이터 복구 가능

#### 3.4.3 의존성

- 의존: SF-001, SF-002, SF-003
- 차단: SF-009 (오프라인 SLAM 처리)

---

### SF-005: 실시간 데이터 스트리밍 (Real-time Data Streaming)

**출처**: FR1.5, FR4.1, FR4.2, FR4.3, FR4.4 (PRD)
**우선순위**: P1
**설명**: WebRTC (비디오) 및 UDP (IMU)를 통해 PC 클라이언트로 실시간 카메라 및 IMU 데이터 스트리밍

#### 3.5.1 유스케이스

##### UC-005: 실시간 스트리밍 세션 (Real-time Streaming Session)

- **행위자**: 사용자, Android 앱, PC 클라이언트
- **사전조건**:
  1. PC 클라이언트 실행 및 리스닝 중
  2. 네트워크 연결 수립됨
  3. 카메라 및 IMU 캡처 준비됨
- **기본 흐름**:
  1. 사용자가 앱 설정에서 PC IP 주소 입력
  2. 사용자가 "연결" 버튼 탭
  3. 앱이 PC와 WebRTC 시그널링 시작
  4. PC가 연결 수락
  5. WebRTC 피어 연결 수립
  6. 앱이 IMU 데이터용 UDP 소켓 수립
  7. 연결 상태가 "연결됨"으로 표시
  8. 사용자가 "스트리밍 시작" 버튼 탭
  9. 캡처된 각 프레임에 대해:
     a. 앱이 WebRTC 비디오 트랙을 통해 프레임 인코딩
     b. 앱이 WebRTC 데이터 채널을 통해 프레임 전송
  10. 각 IMU 샘플에 대해:
      a. 앱이 타임스탬프와 함께 IMU 패키징
      b. 앱이 UDP 소켓을 통해 전송
  11. PC가 데이터 수신 및 처리
  12. 사용자가 "스트리밍 정지" 버튼 탭
  13. 앱이 스트리밍 세션 종료
  14. WebRTC 연결 우아하게 닫힘
- **대안 흐름**:
  - 4a. 연결 타임아웃:
    - 앱이 "연결 실패" 표시
    - 앱이 PC IP/방화벽 확인 제안
  - 9a. 네트워크 혼잡 감지:
    - 앱이 적응형 비트레이트 활성화
    - 앱이 일시적으로 해상도 감소 가능
  - 10a. UDP 패킷 손실 감지:
    - 시스템이 패킷 손실 통계 로그
    - PC가 누락 샘플에 보간 사용
- **예외 흐름**:
  - E1. 네트워크 연결 끊김:
    - 앱이 데이터를 로컬에 버퍼링
    - 앱이 재연결 시도 (최대 5회)
    - 앱이 연결 끊김을 사용자에게 알림
  - E2. PC 클라이언트 크래시:
    - 앱이 연결 손실 감지
    - 앱이 로컬 녹화로 전환 제안
- **사후조건**:
  1. 데이터가 PC로 성공적으로 전송됨
  2. 종단간 지연 시간 < 100ms
  3. 세션 통계 기록됨

#### 3.5.2 인수 기준

- [ ] AC-005.1: WebRTC 비디오 스트림 30 FPS
- [ ] AC-005.2: UDP IMU 전송 200Hz
- [ ] AC-005.3: 종단간 지연 시간 < 100ms (95 퍼센타일)
- [ ] AC-005.4: 네트워크 중단시 자동 재연결
- [ ] AC-005.5: 적응형 비트레이트 2초 이내 응답
- [ ] AC-005.6: 5GHz WiFi 및 USB 테더링에서 작동

#### 3.5.3 의존성

- 의존: SF-001, SF-002, SF-003
- 차단: SF-010 (실시간 SLAM 처리)

---

### SF-006: PC 데이터 수신 (PC Data Reception)

**출처**: FR3.1, FR3.2, FR3.3 (PRD)
**우선순위**: P0
**설명**: PC 클라이언트에서 스마트폰으로부터 비디오/IMU 데이터 수신 및 디코딩

#### 3.6.1 유스케이스

##### UC-006: 데이터 수신 및 디코딩 (Data Reception and Decoding)

- **행위자**: PC 클라이언트
- **사전조건**:
  1. PC 클라이언트 애플리케이션 실행 중
  2. 네트워크 인터페이스 구성됨
  3. 비디오 디코더 초기화됨
- **기본 흐름**:
  1. PC 클라이언트가 구성된 포트에서 WebRTC 리스너 시작
  2. PC 클라이언트가 IMU용 UDP 리스너 시작
  3. 클라이언트가 스마트폰 연결 대기
  4. 연결 수립시:
     a. 클라이언트가 수신 버퍼 할당
     b. 클라이언트가 비디오 디코더 (H.264/H.265) 초기화
  5. 수신된 각 비디오 프레임에 대해:
     a. 클라이언트가 압축 프레임 디코딩
     b. 클라이언트가 메타데이터에서 타임스탬프 추출
     c. 클라이언트가 cv::Mat 형식으로 변환
     d. 클라이언트가 동기화 큐에 추가
  6. 수신된 각 IMU 패킷에 대해:
     a. 클라이언트가 바이너리 IMU 데이터 파싱
     b. 클라이언트가 타임스탬프 검증
     c. 클라이언트가 IMU 버퍼에 추가
  7. 클라이언트가 동기화 알고리즘 실행
  8. 클라이언트가 동기화된 데이터를 SLAM 엔진에 공급
- **대안 흐름**:
  - 5a. 디코드 오류:
    - 클라이언트가 키프레임 요청
    - 클라이언트가 디코드 실패 로그
  - 6a. 순서 맞지 않는 IMU 패킷:
    - 클라이언트가 타임스탬프 기준으로 재정렬
    - 클라이언트가 재정렬 이벤트 로그
- **예외 흐름**:
  - E1. 버퍼 오버플로우:
    - 클라이언트가 가장 오래된 데이터 삭제
    - 클라이언트가 처리 지연 경고
- **사후조건**:
  1. 비디오 프레임 디코딩 및 사용 가능
  2. IMU 데이터 버퍼링 및 동기화됨
  3. SLAM 처리용 데이터 준비됨

#### 3.6.2 인수 기준

- [ ] AC-006.1: H.264 디코딩 30 FPS
- [ ] AC-006.2: H.265 디코딩 지원 (선택)
- [ ] AC-006.3: IMU 파싱 500Hz 용량
- [ ] AC-006.4: 동기화 정확도 < 1ms
- [ ] AC-006.5: 버퍼가 2초 네트워크 지터 처리

#### 3.6.3 의존성

- 의존: SF-005 (스트리밍)
- 차단: SF-010 (실시간 SLAM)

---

### SF-007: VI-SLAM 프레임워크 통합 (VI-SLAM Framework Integration)

**출처**: FR3.4, FR7.1, FR7.2, FR7.3, FR7.4, FR7.5 (PRD)
**우선순위**: P0
**설명**: 통합 인터페이스로 다중 VI-SLAM 프레임워크 통합

#### 3.7.1 유스케이스

##### UC-007: VINS-Mono 통합

- **행위자**: PC 클라이언트, SLAM 엔진
- **사전조건**:
  1. VINS-Mono 설치 및 구성됨
  2. 캘리브레이션 파일 사용 가능
  3. 데이터 소스 준비됨 (스트리밍 또는 파일)
- **기본 흐름**:
  1. 사용자가 VINS-Mono를 SLAM 프레임워크로 선택
  2. 시스템이 VINS-Mono 구성 로드
  3. 시스템이 VINS-Mono 추정기 초기화
  4. 시스템이 초기화 단계 진입:
     a. 초기 프레임 및 IMU 수집
     b. SfM 초기화 수행
     c. 시각-관성 참조 정렬
  5. 성공적인 초기화시:
     a. 시스템이 추적 모드로 전환
     b. 상태가 "TRACKING"으로 변경
  6. 각 동기화된 프레임+IMU에 대해:
     a. 시스템이 이미지를 프론트엔드에 공급
     b. 시스템이 IMU를 사전 적분에 공급
     c. 시스템이 최적화 실행
     d. 시스템이 6DoF 포즈 출력
  7. 시스템이 3D 포인트 맵 유지
  8. 추적 손실시:
     a. 시스템이 재위치추정 시도
     b. 실패시, 시스템이 재초기화
- **대안 흐름**:
  - 4a. 초기화 실패 (불충분한 움직임):
    - 시스템이 안내 메시지 제공
    - 시스템이 리셋 후 재시도
  - 6a. 특징 품질 불량:
    - 시스템이 저하된 추적 경고
    - 시스템이 재위치추정 트리거 가능
- **예외 흐름**:
  - E1. VINS-Mono 크래시:
    - 시스템이 오류 상태 캡처
    - 시스템이 재시작 옵션 제공
- **사후조건**:
  1. 30Hz로 연속 6DoF 포즈 출력
  2. 새 관측으로 맵 업데이트됨
  3. 궤적 로그됨

##### UC-008: 다중 프레임워크 선택 (Multi-Framework Selection)

- **행위자**: 사용자, PC 클라이언트
- **사전조건**:
  1. 최소 하나의 프레임워크 설치됨
  2. 프레임워크 구성 파일 사용 가능
- **기본 흐름**:
  1. 사용자가 프레임워크 선택 대화상자 열기
  2. 시스템이 사용 가능한 프레임워크 표시:
     - VINS-Mono (설치됨/미설치)
     - OpenVINS (설치됨/미설치)
     - ORB-SLAM3 (설치됨/미설치)
     - Basalt (설치됨/미설치)
  3. 사용자가 원하는 프레임워크 선택
  4. 시스템이 프레임워크 설치 검증
  5. 시스템이 프레임워크 특정 어댑터 로드
  6. 시스템이 필요시 캘리브레이션 변환 적용
  7. 시스템이 프레임워크 준비 확인
- **대안 흐름**:
  - 4a. 프레임워크 미설치:
    - 시스템이 설치 지침 제공
    - 시스템이 대체 프레임워크 제안
- **사후조건**:
  1. 선택된 프레임워크 초기화됨
  2. 통합 인터페이스 사용 준비됨

#### 3.7.2 인수 기준

- [ ] AC-007.1: VINS-Mono 통합 완료 (P0)
- [ ] AC-007.2: OpenVINS 통합 완료 (P1)
- [ ] AC-007.3: ORB-SLAM3 통합 완료 (P1)
- [ ] AC-007.4: Basalt 통합 가능 (P2)
- [ ] AC-007.5: 재시작 없이 프레임워크 전환
- [ ] AC-007.6: EuRoC에서 위치 정확도 ATE RMSE < 0.15m
- [ ] AC-007.7: 30Hz 입력/출력으로 실시간 처리

#### 3.7.3 의존성

- 의존: SF-006 (데이터 수신)
- 차단: SF-011 (출력 및 내보내기)

---

### SF-008: 센서 캘리브레이션 (Sensor Calibration)

**출처**: FR8.1, FR8.2, FR8.3, FR8.4, FR8.5 (PRD)
**우선순위**: P0 (내부), P1 (외부), P2 (자동)
**설명**: 카메라 내부 파라미터, 카메라-IMU 외부 파라미터 및 시간 오프셋 캘리브레이션

#### 3.8.1 유스케이스

##### UC-009: 카메라 내부 파라미터 캘리브레이션 (Camera Intrinsic Calibration)

- **행위자**: 사용자, 캘리브레이션 모듈
- **사전조건**:
  1. 캘리브레이션 타겟 (체스보드) 준비됨
  2. 카메라 캡처 초기화됨
  3. 좋은 조명 조건
- **기본 흐름**:
  1. 사용자가 "카메라 캘리브레이션" 모드 선택
  2. 시스템이 캘리브레이션 가이드 표시
  3. 시스템이 감지 오버레이와 함께 라이브 카메라 피드 표시
  4. 사용자가 다양한 각도에서 체스보드 캡처:
     a. 시스템이 코너 포인트 감지
     b. 시스템이 커버리지 피드백 제공 (25개 영역)
     c. 시스템이 캡처에 "좋은" 포즈 표시
     d. 사용자가 캡처 트리거 (자동 또는 수동)
  5. 최소 20회 캡처 후:
     a. 시스템이 "캘리브레이션" 버튼 활성화
  6. 사용자가 "캘리브레이션" 탭
  7. 시스템이 Zhang 방법 캘리브레이션 실행
  8. 시스템이 계산:
     - 초점 거리 (fx, fy)
     - 주점 (cx, cy)
     - 왜곡 계수 (k1, k2, p1, p2)
  9. 시스템이 재투영 오차 표시
  10. 오차 < 0.5 픽셀인 경우:
      a. 시스템이 캘리브레이션 저장
      b. 시스템이 성공 메시지 표시
  11. 오차 >= 0.5 픽셀인 경우:
      a. 시스템이 재캡처 제안
      b. 시스템이 문제 이미지 강조
- **대안 흐름**:
  - 4a. 코너 감지 실패:
    - 시스템이 타겟 가시성에 대한 피드백 제공
    - 시스템이 조명/각도 조정 제안
  - 9a. 높은 재투영 오차:
    - 시스템이 이상값 이미지 제거 허용
    - 시스템이 캘리브레이션 재계산
- **사후조건**:
  1. 카메라 내부 파라미터 저장됨
  2. 재투영 오차 < 0.5 픽셀

##### UC-010: 카메라-IMU 외부 파라미터 캘리브레이션 (Camera-IMU Extrinsic Calibration)

- **행위자**: 사용자, 캘리브레이션 모듈, Kalibr 도구
- **사전조건**:
  1. 카메라 내부 파라미터 캘리브레이션됨
  2. AprilGrid 타겟 준비됨
  3. PC에 Kalibr 설치됨
- **기본 흐름**:
  1. 사용자가 "카메라-IMU 캘리브레이션" 모드 선택
  2. 시스템이 움직임 가이드 표시
  3. 사용자가 60초 동안 다양한 방향으로 기기 이동:
     - 롤, 피치, 요 회전
     - 병진 이동
  4. 시스템이 동기화된 카메라 + IMU 데이터 기록
  5. 시스템이 Kalibr 형식으로 데이터 내보내기
  6. 사용자가 PC에서 Kalibr 실행:
     a. Kalibr가 캘리브레이션 데이터 처리
     b. Kalibr가 외부 변환 추정
     c. Kalibr가 시간 오프셋 추정
  7. 시스템이 Kalibr 결과 가져오기
  8. 시스템이 calibration.yaml 저장
- **대안 흐름**:
  - 3a. 불충분한 움직임 다양성:
    - 시스템이 특정 움직임 가이드 제공
    - 시스템이 녹화 시간 연장
- **사후조건**:
  1. 카메라-IMU 외부 파라미터 (T_cam_imu) 저장됨
  2. 시간 오프셋 (td) 추정됨
  3. 캘리브레이션 정확도 검증됨

#### 3.8.2 인수 기준

- [ ] AC-008.1: 카메라 내부 파라미터 재투영 오차 < 0.5 픽셀
- [ ] AC-008.2: 외부 파라미터 캘리브레이션 Kalibr 호환
- [ ] AC-008.3: 시간 오프셋 정확도 < 1ms
- [ ] AC-008.4: 캘리브레이션 프로세스 10분 이내 완료
- [ ] AC-008.5: 캘리브레이션 결과 YAML/JSON 형식으로 내보내기 가능
- [ ] AC-008.6: 핀홀 및 어안 카메라 모델 지원

#### 3.8.3 의존성

- 의존: SF-001, SF-002, SF-004
- 차단: SF-007 (SLAM 통합)

---

### SF-009: 오프라인 SLAM 처리 (Offline SLAM Processing)

**출처**: UC3 (PRD)
**우선순위**: P1
**설명**: 녹화된 데이터셋을 오프라인으로 VI-SLAM 프레임워크를 통해 처리

#### 3.9.1 유스케이스

##### UC-011: 오프라인 데이터셋 처리 (Offline Dataset Processing)

- **행위자**: 사용자, PC 클라이언트
- **사전조건**:
  1. 녹화된 데이터셋 사용 가능
  2. VI-SLAM 프레임워크 설치됨
  3. 캘리브레이션 파일 사용 가능
- **기본 흐름**:
  1. 사용자가 데이터셋 디렉토리 선택
  2. 시스템이 데이터셋 형식 검증:
     - video.mp4 / images/ 확인
     - imu.csv 확인
     - metadata.json 확인
  3. 시스템이 데이터셋 통계 표시
  4. 사용자가 SLAM 프레임워크 선택
  5. 사용자가 처리 옵션 구성:
     - 출력 형식 (궤적, 포인트 클라우드)
     - 시각화 (활성화/비활성화)
  6. 사용자가 "처리 시작" 클릭
  7. 시스템이 필요시 데이터를 프레임워크 형식으로 변환
  8. 시스템이 데이터를 SLAM 엔진에 공급:
     - 진행률 표시줄이 완료 퍼센트 표시
     - 실시간 시각화 (선택)
  9. SLAM 엔진이 모든 데이터 처리
  10. 시스템이 결과 파일 저장:
      - trajectory.txt (TUM 형식)
      - pointcloud.ply
      - keyframes/ (선택)
  11. 시스템이 처리 보고서 생성
- **대안 흐름**:
  - 2a. 잘못된 데이터셋 형식:
    - 시스템이 특정 오류 표시
    - 시스템이 변환 도구 제안
  - 8a. 처리 오류:
    - 시스템이 부분 결과 저장
    - 시스템이 오류 세부사항 로그
- **사후조건**:
  1. 궤적 파일 생성됨
  2. 포인트 클라우드 저장됨 (활성화시)
  3. 처리 통계 로그됨

#### 3.9.2 인수 기준

- [ ] AC-009.1: EuRoC 데이터셋 형식 지원
- [ ] AC-009.2: 사용자 녹화 데이터셋 지원
- [ ] AC-009.3: TUM 형식 궤적 출력
- [ ] AC-009.4: PLY 형식 포인트 클라우드 출력
- [ ] AC-009.5: 처리 중 진행률 표시
- [ ] AC-009.6: 처리 보고서에 ATE 메트릭 포함

#### 3.9.3 의존성

- 의존: SF-004, SF-007, SF-008
- 차단: SF-011 (출력 및 내보내기)

---

### SF-010: 실시간 SLAM 처리 (Real-time SLAM Processing)

**출처**: UC1 (PRD)
**우선순위**: P1
**설명**: 스트리밍 데이터로 실시간 VI-SLAM 수행

#### 3.10.1 유스케이스

##### UC-012: 실시간 포즈 추정 (Real-time Pose Estimation)

- **행위자**: 사용자, Android 앱, PC 클라이언트, 외부 애플리케이션
- **사전조건**:
  1. 스트리밍 연결 수립됨
  2. SLAM 프레임워크 초기화됨
  3. 캘리브레이션 로드됨
- **기본 흐름**:
  1. 사용자가 앱에서 스트리밍 시작
  2. PC가 동기화된 데이터 수신
  3. SLAM 엔진 초기화:
     - 상태: INITIALIZING
     - 사용자가 움직임 제공을 위해 기기 이동
  4. 성공적인 초기화시:
     - 상태: TRACKING
     - 시스템이 포즈 출력 시작
  5. 30Hz로 각 프레임에 대해:
     a. 시스템이 프레임 + IMU 처리
     b. 시스템이 6DoF 포즈 추정
     c. 시스템이 API/ROS를 통해 포즈 발행
     d. 시스템이 시각화 업데이트
  6. 외부 애플리케이션이 포즈 데이터 수신
  7. 사용자가 스트리밍 정지
  8. 시스템이 세션 요약 출력
- **대안 흐름**:
  - 3a. 초기화 타임아웃 (30초):
    - 시스템이 움직임 가이드 제공
    - 시스템이 초기화 리셋
  - 5a. 추적 손실:
    - 상태: LOST
    - 시스템이 재위치추정 시도
    - 성공시: 상태: TRACKING
    - 5초 후 실패시: 재초기화
- **예외 흐름**:
  - E1. 종단간 지연 시간 100ms 초과:
    - 시스템이 경고 로그
    - 시스템이 따라잡기 위해 프레임 스킵 가능
- **사후조건**:
  1. 추적 중 30Hz로 연속 포즈 출력
  2. 지연 시간 < 100ms 유지
  3. 추적 유지율 > 95%

#### 3.10.2 인수 기준

- [ ] AC-010.1: 추적 중 30Hz로 포즈 출력
- [ ] AC-010.2: 종단간 지연 시간 < 100ms (95 퍼센타일)
- [ ] AC-010.3: 위치 정확도 ATE RMSE < 0.1m
- [ ] AC-010.4: 추적 유지율 > 95%
- [ ] AC-010.5: 추적 손실로부터 자동 복구
- [ ] AC-010.6: 최대 30분 세션 지속시간

#### 3.10.3 의존성

- 의존: SF-005, SF-006, SF-007, SF-008
- 차단: SF-011 (출력 및 내보내기)

---

### SF-011: 출력 및 내보내기 (Output and Export)

**출처**: FR9.1, FR9.2, FR9.3, FR9.4 (PRD)
**우선순위**: P0 (궤적), P1 (포인트 클라우드, API), P2 (메쉬)
**설명**: SLAM 결과 내보내기 및 실시간 포즈 API 제공

#### 3.11.1 유스케이스

##### UC-013: 궤적 내보내기 (Trajectory Export)

- **행위자**: 사용자, 내보내기 모듈
- **사전조건**:
  1. SLAM 세션 완료 또는 진행 중
  2. 궤적 데이터 사용 가능
- **기본 흐름**:
  1. 사용자가 "궤적 내보내기" 선택
  2. 시스템이 형식 옵션 표시:
     - TUM 형식 (timestamp tx ty tz qx qy qz qw)
     - KITTI 형식 (3x4 변환 행렬)
     - EuRoC 형식
  3. 사용자가 출력 형식 선택
  4. 사용자가 출력 경로 지정
  5. 시스템이 궤적 내보내기
  6. 시스템이 내보내기 확인 표시
- **사후조건**:
  1. 선택된 형식으로 궤적 파일 저장됨
  2. 모든 포즈가 타임스탬프와 함께 포함됨

##### UC-014: 실시간 포즈 API (Real-time Pose API)

- **행위자**: 외부 애플리케이션, 출력 모듈
- **사전조건**:
  1. 실시간 SLAM 진행 중
  2. ROS 또는 ZMQ 인터페이스 구성됨
- **기본 흐름**:
  1. 외부 애플리케이션이 포즈 API에 연결
  2. 시스템이 각 SLAM 출력에서 포즈 발행:
     a. ROS: /vi_slam/pose (geometry_msgs/PoseStamped)
     b. ZMQ: JSON 형식 포즈 메시지
  3. 외부 애플리케이션이 포즈 수신 및 사용
  4. 세션 종료까지 연결 유지
- **대안 흐름**:
  - 1a. 연결 실패:
    - 시스템이 연결 재시도
    - 시스템이 연결 오류 로그
- **사후조건**:
  1. 실시간으로 포즈 전달됨
  2. API 지연 시간 < 10ms

##### UC-015: 포인트 클라우드 내보내기 (Point Cloud Export)

- **행위자**: 사용자, 내보내기 모듈
- **사전조건**:
  1. SLAM에서 맵 사용 가능
  2. SLAM 세션이 맵 내보내기 허용
- **기본 흐름**:
  1. 사용자가 "포인트 클라우드 내보내기" 선택
  2. 시스템이 형식 옵션 표시:
     - PLY (ASCII/Binary)
     - PCD
  3. 사용자가 형식 및 옵션 선택
  4. 시스템이 포인트 클라우드 내보내기
  5. 시스템이 내보내기 확인 표시
- **사후조건**:
  1. 포인트 클라우드 파일 저장됨
  2. 가능한 경우 색상 정보 포함됨

#### 3.11.2 인수 기준

- [ ] AC-011.1: TUM 형식 궤적 내보내기
- [ ] AC-011.2: KITTI 형식 궤적 내보내기
- [ ] AC-011.3: PLY 포인트 클라우드 내보내기
- [ ] AC-011.4: 포즈 속도로 ROS 토픽 발행
- [ ] AC-011.5: < 10ms 지연 시간으로 ZMQ API
- [ ] AC-011.6: 일반적인 세션에서 5초 이내 내보내기 완료

#### 3.11.3 의존성

- 의존: SF-007, SF-009, SF-010
- 차단: 없음 (출력 기능)

---

### SF-012: 시각화 (Visualization)

**출처**: FR3.5 (PRD)
**우선순위**: P1
**설명**: 궤적, 포인트 클라우드 및 카메라 피드의 실시간 시각화

#### 3.12.1 유스케이스

##### UC-016: 실시간 시각화 (Real-time Visualization)

- **행위자**: 사용자, 시각화 모듈
- **사전조건**:
  1. SLAM 세션 활성
  2. 디스플레이 사용 가능
- **기본 흐름**:
  1. 사용자가 시각화 활성화
  2. 시스템이 시각화 창 생성
  3. 시스템이 표시:
     - 특징이 있는 카메라 피드
     - 3D 궤적 플롯
     - 포인트 클라우드 (사용 가능시)
     - 상태 정보
  4. 시각화가 30Hz로 업데이트
  5. 사용자가 상호작용 가능:
     - 3D 뷰 회전/줌
     - 표시 요소 토글
  6. 사용자가 시각화 닫기
- **사후조건**:
  1. 실시간 시각적 피드백 제공됨
  2. 성능 영향 < 20% CPU

#### 3.12.2 인수 기준

- [ ] AC-012.1: 30 FPS 시각화 갱신
- [ ] AC-012.2: 인터랙티브 3D 뷰 (회전, 줌)
- [ ] AC-012.3: 궤적, 포인트 클라우드, 카메라 피드 표시
- [ ] AC-012.4: 상태 오버레이 (FPS, 추적 상태)
- [ ] AC-012.5: CPU 오버헤드 < 20%

#### 3.12.3 의존성

- 의존: SF-007, SF-010
- 차단: 없음

---

### SF-013: ROS 통합 (ROS Integration)

**출처**: FR3.7 (PRD)
**우선순위**: P1
**설명**: 로보틱스 스택과의 통합을 위해 ROS 토픽에 SLAM 출력 발행

#### 3.13.1 유스케이스

##### UC-017: ROS 토픽 발행 (ROS Topic Publishing)

- **행위자**: PC 클라이언트, ROS 네트워크
- **사전조건**:
  1. ROS (Noetic 또는 Humble) 설치됨
  2. roscore 실행 중 (ROS 1) 또는 데몬 활성 (ROS 2)
  3. SLAM 세션 활성
- **기본 흐름**:
  1. 사용자가 ROS 발행 활성화
  2. 시스템이 ROS 노드 "vi_slam_node" 생성
  3. 시스템이 토픽 광고:
     - /vi_slam/pose (PoseStamped)
     - /vi_slam/odometry (Odometry)
     - /vi_slam/path (Path)
     - /vi_slam/pointcloud (PointCloud2)
     - /vi_slam/image (Image) - 선택
  4. 각 SLAM 출력에 대해:
     a. 시스템이 ROS 메시지 생성
     b. 시스템이 적절한 토픽에 발행
  5. ROS 구독자가 데이터 수신
  6. 세션 종료시, 시스템이 노드를 깨끗하게 종료
- **사후조건**:
  1. ROS 토픽 활발히 발행 중
  2. TF 변환 발행됨 (map -> odom -> base_link)

#### 3.13.2 인수 기준

- [ ] AC-013.1: ROS Noetic (ROS 1) 지원
- [ ] AC-013.2: ROS Humble (ROS 2) 지원
- [ ] AC-013.3: 표준 메시지 유형 사용
- [ ] AC-013.4: TF 트리 발행됨
- [ ] AC-013.5: RViz 시각화와 작동

#### 3.13.3 의존성

- 의존: SF-010
- 차단: 없음

---

### SF-014: 설정 및 구성 UI (Settings and Configuration UI)

**출처**: FR1.6, FR1.7 (PRD)
**우선순위**: P1
**설명**: 캡처 및 표시 설정을 구성하기 위한 사용자 인터페이스

#### 3.14.1 유스케이스

##### UC-018: 구성 관리 (Configuration Management)

- **행위자**: 사용자
- **사전조건**:
  1. 애플리케이션 실행 중
- **기본 흐름**:
  1. 사용자가 설정 열기
  2. 시스템이 구성 카테고리 표시:
     - 카메라: 해상도, FPS, 노출 모드
     - IMU: 샘플링 주파수, 센서 유형
     - 스트리밍: 서버 IP, 포트, 프로토콜
     - 저장: 출력 디렉토리, 파일 형식
  3. 사용자가 설정 수정
  4. 시스템이 설정 검증
  5. 사용자가 설정 저장
  6. 시스템이 변경사항 적용
- **사후조건**:
  1. 설정 지속됨
  2. 변경사항 적용됨

#### 3.14.2 인수 기준

- [ ] AC-014.1: 카메라 해상도 선택 (720p, 1080p)
- [ ] AC-014.2: FPS 선택 (15, 30, 60)
- [ ] AC-014.3: IMU 주파수 선택 (100-500Hz)
- [ ] AC-014.4: 재시작 간 설정 지속
- [ ] AC-014.5: 설정 실시간 미리보기

#### 3.14.3 의존성

- 의존: SF-001, SF-002
- 차단: 없음

---

### SF-015: 상태 표시 (Status Display)

**출처**: FR1.7 (PRD)
**우선순위**: P1
**설명**: FPS, 연결 및 버퍼 상태를 포함한 실시간 시스템 상태 표시

#### 3.15.1 유스케이스

##### UC-019: 상태 모니터링 (Status Monitoring)

- **행위자**: 사용자
- **사전조건**:
  1. 애플리케이션 실행 중
  2. 캡처 또는 스트리밍 활성
- **기본 흐름**:
  1. 시스템이 상태 오버레이 표시:
     - 카메라 FPS (실제)
     - IMU 속도 (실제)
     - 연결 상태 (연결됨/연결 안됨)
     - 버퍼 사용률 (%)
     - 녹화 지속시간/크기
  2. 상태가 500ms마다 업데이트
  3. 경고가 황색/적색으로 강조
- **사후조건**:
  1. 사용자가 시스템 상태 인지

#### 3.15.2 인수 기준

- [ ] AC-015.1: 실시간 FPS 표시
- [ ] AC-015.2: 연결 상태 표시기
- [ ] AC-015.3: 버퍼 사용률 표시
- [ ] AC-015.4: 문제에 대한 경고 표시기
- [ ] AC-015.5: 업데이트 속도 >= 2Hz

#### 3.15.3 의존성

- 의존: SF-001, SF-002, SF-005
- 차단: 없음

---

## 4. 외부 인터페이스 요구사항

### 4.1 사용자 인터페이스 (User Interfaces)

#### 4.1.1 Android 애플리케이션 UI

| 화면 ID | 이름 | 설명 |
|---------|------|------|
| UI-001 | 메인 화면 | 카메라 미리보기, 녹화/스트림 버튼, 상태 표시 |
| UI-002 | 설정 화면 | 캡처 구성 옵션 |
| UI-003 | 캘리브레이션 화면 | 단계별 캘리브레이션 가이드 |
| UI-004 | 세션 기록 | 녹화된 세션 목록 |
| UI-005 | 연결 화면 | 서버 IP 입력, 연결 상태 |

**UI-001: 메인 화면 와이어프레임**
```
+----------------------------------+
|  VI-SLAM            [설정]       |
+----------------------------------+
|                                  |
|                                  |
|       [카메라 미리보기]           |
|                                  |
|                                  |
+----------------------------------+
| FPS: 30  IMU: 200Hz  [연결됨]    |
+----------------------------------+
|  [녹화]    [스트림]    [정지]     |
+----------------------------------+
```

#### 4.1.2 PC 클라이언트 UI

| 화면 ID | 이름 | 설명 |
|---------|------|------|
| UI-101 | 대시보드 | 연결 상태, 데이터 수신 통계 |
| UI-102 | 시각화 | 3D 궤적, 포인트 클라우드 뷰어 |
| UI-103 | 구성 | 프레임워크 선택, 캘리브레이션 로더 |
| UI-104 | 처리 | 오프라인 데이터셋 프로세서 |
| UI-105 | 내보내기 | 출력 형식 선택 |

### 4.2 API 인터페이스

#### 4.2.1 스마트폰-PC 통신

| 엔드포인트 | 프로토콜 | 방향 | 설명 |
|----------|---------|------|------|
| WebRTC Video | WebRTC/DTLS | 앱 -> PC | H.264 인코딩 비디오 프레임 |
| WebRTC Data | WebRTC/SCTP | 앱 <-> PC | 제어 메시지, 메타데이터 |
| IMU Stream | UDP | 앱 -> PC | 바이너리 IMU 데이터 패킷 |
| Control | TCP | PC -> 앱 | 시작/정지 명령 |

**IMU UDP 패킷 형식:**
```
오프셋  크기  유형    필드
0       8     int64   timestamp_ns
8       8     double  acc_x (m/s^2)
16      8     double  acc_y
24      8     double  acc_z
32      8     double  gyro_x (rad/s)
40      8     double  gyro_y
48      8     double  gyro_z
총합: 샘플당 56 바이트
```

**WebRTC 데이터 채널 메시지:**
```json
{
  "type": "frame_metadata",
  "timestamp_ns": 1234567890123456789,
  "sequence": 12345,
  "exposure_ns": 8333333,
  "iso": 100
}
```

#### 4.2.2 SLAM 프레임워크 어댑터 인터페이스

```cpp
class ISLAMFramework {
public:
    virtual ~ISLAMFramework() = default;

    // 초기화 (Initialization)
    virtual bool initialize(const std::string& config_path) = 0;
    virtual bool loadCalibration(const std::string& calib_path) = 0;

    // 데이터 입력 (Data input)
    virtual void processImage(const cv::Mat& image, int64_t timestamp_ns) = 0;
    virtual void processIMU(const IMUSample& imu) = 0;

    // 출력 (Output)
    virtual bool getPose(Pose6DoF& pose) const = 0;
    virtual TrackingStatus getStatus() const = 0;
    virtual std::vector<MapPoint> getMapPoints() const = 0;

    // 제어 (Control)
    virtual void reset() = 0;
    virtual void shutdown() = 0;
};

struct Pose6DoF {
    int64_t timestamp_ns;
    double position[3];      // x, y, z (미터)
    double orientation[4];   // qw, qx, qy, qz (쿼터니언)
    double covariance[36];   // 6x6 공분산 행렬 (선택)
};

enum class TrackingStatus {
    INITIALIZING,
    TRACKING,
    LOST,
    RELOCALIZATION
};
```

#### 4.2.3 ROS 인터페이스

**발행 토픽 (ROS 1/2):**

| 토픽 | 메시지 유형 | 속도 | 설명 |
|------|-----------|------|------|
| /vi_slam/pose | geometry_msgs/PoseStamped | 30 Hz | 현재 포즈 |
| /vi_slam/odometry | nav_msgs/Odometry | 30 Hz | 속도 포함 포즈 |
| /vi_slam/path | nav_msgs/Path | 1 Hz | 전체 궤적 |
| /vi_slam/pointcloud | sensor_msgs/PointCloud2 | 1 Hz | 맵 포인트 |
| /vi_slam/image | sensor_msgs/Image | 30 Hz | 카메라 피드 |
| /vi_slam/status | std_msgs/String | 1 Hz | 추적 상태 |

**TF 프레임:**
```
map
 └── odom
      └── base_link
           └── camera_link
           └── imu_link
```

#### 4.2.4 ZMQ 포즈 API

**소켓 구성:**
- 유형: PUB/SUB
- 포트: 5555 (구성 가능)
- 프로토콜: TCP

**메시지 형식 (JSON):**
```json
{
  "timestamp_ns": 1234567890123456789,
  "position": {
    "x": 1.234,
    "y": 2.345,
    "z": 0.567
  },
  "orientation": {
    "w": 0.707,
    "x": 0.0,
    "y": 0.707,
    "z": 0.0
  },
  "status": "TRACKING",
  "velocity": {
    "linear": [0.1, 0.0, 0.0],
    "angular": [0.0, 0.0, 0.01]
  }
}
```

### 4.3 하드웨어 인터페이스 (Hardware Interfaces)

| 인터페이스 | 설명 | 요구사항 |
|----------|------|---------|
| 카메라 | Camera2 API를 통한 후면 카메라 접근 | HARDWARE_LEVEL_LIMITED+ |
| IMU | SensorManager를 통한 가속도계 + 자이로스코프 | TYPE_ACCELEROMETER, TYPE_GYROSCOPE |
| 저장소 | 녹화용 내부/외부 저장소 | 읽기/쓰기 권한 |
| 네트워크 | 스트리밍용 WiFi 또는 USB 테더링 | 5 Mbps+ 대역폭 |
| 디스플레이 | UI 및 미리보기용 화면 | 최소 720p |

### 4.4 소프트웨어 인터페이스 (Software Interfaces)

| 인터페이스 | 설명 | 버전 |
|----------|------|------|
| Android Camera2 API | 카메라 캡처 인터페이스 | API 26+ |
| Android SensorManager | IMU 센서 접근 | API 26+ |
| Google libwebrtc | WebRTC 구현 | M100+ |
| OpenCV | 이미지 처리 | 4.5+ |
| Eigen3 | 선형 대수 | 3.3+ |
| Ceres Solver | 비선형 최적화 | 2.0+ |
| ROS | 로봇 운영 체제 | Noetic/Humble |
| ZeroMQ | 메시지 큐 라이브러리 | 4.3+ |

### 4.5 통신 인터페이스 (Communication Interfaces)

#### 4.5.1 WebRTC 시그널링

**시그널링 서버 프로토콜 (WebSocket):**

```json
// Offer (앱 -> 시그널링 서버 -> PC)
{
  "type": "offer",
  "sdp": "v=0\r\no=- ..."
}

// Answer (PC -> 시그널링 서버 -> 앱)
{
  "type": "answer",
  "sdp": "v=0\r\no=- ..."
}

// ICE Candidate
{
  "type": "candidate",
  "candidate": "candidate:..."
}
```

#### 4.5.2 네트워크 구성

| 파라미터 | 기본값 | 범위 |
|---------|-------|------|
| WebRTC 포트 | 8080 | 1024-65535 |
| UDP IMU 포트 | 9000 | 1024-65535 |
| TCP 제어 포트 | 9001 | 1024-65535 |
| ZMQ 포즈 포트 | 5555 | 1024-65535 |
| ROS 마스터 URI | localhost:11311 | 구성 가능 |

---

## 5. 비기능적 요구사항

### 5.1 성능 요구사항 (Performance Requirements)

| ID | 요구사항 | 메트릭 | 목표값 | 측정 방법 |
|----|---------|--------|--------|----------|
| NFR-P001 | 종단간 지연 시간 | 캡처에서 포즈 출력까지 시간 | < 100 ms | 타임스탬프 차이 측정 |
| NFR-P002 | 위치 정확도 | ATE RMSE | < 0.1 m | EuRoC 벤치마크 비교 |
| NFR-P003 | 처리 속도 | SLAM 출력 속도 | >= 30 FPS | 출력 속도 측정 |
| NFR-P004 | IMU 샘플링 속도 | 실제 샘플링 주파수 | >= 200 Hz | 앱 내 측정 |
| NFR-P005 | 프레임 드롭률 | 드롭된 프레임 비율 | < 1% | 프레임 카운터 분석 |
| NFR-P006 | 앱 CPU 사용량 | 앱의 CPU 사용률 | < 50% | Android 프로파일러 |
| NFR-P007 | 앱 메모리 사용량 | 앱이 사용하는 RAM | < 500 MB | Android 프로파일러 |
| NFR-P008 | PC CPU 사용량 | VI-SLAM 처리 | < 80% | 시스템 모니터 |
| NFR-P009 | PC 메모리 사용량 | 총 RAM 사용량 | < 4 GB | 시스템 모니터 |
| NFR-P010 | 네트워크 대역폭 | 스트리밍에 필요한 대역폭 | < 10 Mbps | 네트워크 모니터 |

### 5.2 신뢰성 요구사항 (Reliability Requirements)

| ID | 요구사항 | 메트릭 | 목표값 | 검증 |
|----|---------|--------|--------|------|
| NFR-R001 | 시스템 가동 시간 | 연속 작동 시간 | >= 30 분 | 장시간 테스트 |
| NFR-R002 | 추적 유지율 | 성공적인 추적 비율 | >= 95% | 정상 조건 테스트 |
| NFR-R003 | 데이터 무결성 | 손상 없는 데이터 저장 | 100% | 체크섬 검증 |
| NFR-R004 | 오류 복구 | 네트워크 손실시 자동 재연결 | 5초 이내 | 연결 끊김 테스트 |
| NFR-R005 | 크래시율 | 세션당 애플리케이션 크래시 | < 0.1% | 크래시 리포팅 |
| NFR-R006 | 초기화 성공률 | 성공적인 SLAM 초기화 | >= 95% | 반복 초기화 테스트 |

### 5.3 사용성 요구사항 (Usability Requirements)

| ID | 요구사항 | 메트릭 | 목표값 | 검증 |
|----|---------|--------|--------|------|
| NFR-U001 | 설치 시간 | 설정 완료까지 시간 | < 30 분 | 사용자 테스트 |
| NFR-U002 | 캘리브레이션 시간 | 캘리브레이션 완료까지 시간 | < 10 분 | 사용자 테스트 |
| NFR-U003 | 학습 곡선 | 기본 숙련까지 시간 | < 1 일 | 사용자 피드백 |
| NFR-U004 | 문서화 | 기능 커버리지 | 100% | 문서 검토 |
| NFR-U005 | 오류 메시지 | 명확성 및 실행 가능성 | 해결책 포함 | 사용자 피드백 |
| NFR-U006 | 첫 실행 성공률 | 첫 세션 완료하는 사용자 | >= 90% | 사용자 테스트 |

### 5.4 호환성 요구사항 (Compatibility Requirements)

| ID | 요구사항 | 사양 |
|----|---------|------|
| NFR-C001 | Android 버전 | 8.0 (API 26) 이상 |
| NFR-C002 | iOS 버전 | 11.0 이상 (2단계) |
| NFR-C003 | PC 운영체제 | Ubuntu 20.04/22.04, Windows 10/11 (WSL) |
| NFR-C004 | ROS 버전 | Noetic (ROS 1), Humble (ROS 2) |
| NFR-C005 | 지원 기기 | >= 20개 스마트폰 모델 검증 |
| NFR-C006 | 프레임워크 호환성 | VINS-Mono, OpenVINS, ORB-SLAM3, Basalt |

### 5.5 보안 요구사항 (Security Requirements)

| ID | 요구사항 | 설명 | 구현 |
|----|---------|------|------|
| NFR-S001 | 데이터 암호화 | 스트리밍 데이터 암호화 | WebRTC를 통한 DTLS |
| NFR-S002 | 로컬 저장소 | 앱 전용 저장소 보호 | Android 앱 샌드박스 |
| NFR-S003 | 권한 | 최소 권한 요청 | 카메라, 저장소, 네트워크만 |
| NFR-S004 | 네트워크 인증 | 선택적 연결 인증 | 사전 공유 키 옵션 |
| NFR-S005 | 데이터 프라이버시 | 외부 서버로 데이터 전송 안함 | 로컬 전용 처리 |

### 5.6 유지보수성 요구사항 (Maintainability Requirements)

| ID | 요구사항 | 메트릭 | 목표값 |
|----|---------|--------|--------|
| NFR-M001 | 코드 커버리지 | 테스트 커버리지 비율 | >= 70% |
| NFR-M002 | 문서화 | 공개 API 문서화 | 100% |
| NFR-M003 | 모듈성 | 모듈 결합도 | 느슨한 결합 설계 |
| NFR-M004 | CI/CD | 자동화된 빌드 및 테스트 | 모든 커밋 |
| NFR-M005 | 코드 스타일 | 스타일 가이드 준수 | 린터로 강제 |

### 5.7 이식성 요구사항 (Portability Requirements)

| ID | 요구사항 | 설명 |
|----|---------|------|
| NFR-PT001 | 플랫폼 추상화 | 프레임워크 독립적 데이터 인터페이스 |
| NFR-PT002 | 구성 | 외부 구성 파일 |
| NFR-PT003 | 의존성 | 문서화된 의존성 관리 |
| NFR-PT004 | 크로스 플랫폼 | PC 클라이언트가 Linux 및 Windows (WSL)에서 실행 |

---

## 6. 데이터 요구사항

### 6.1 데이터 엔티티 (Data Entities)

#### 6.1.1 IMU 샘플 (IMU Sample)

| 필드 | 유형 | 단위 | 설명 |
|------|------|------|------|
| timestamp | int64 | 나노초 | 센서 타임스탬프 (CLOCK_BOOTTIME) |
| acc_x | float64 | m/s^2 | X축 가속도 |
| acc_y | float64 | m/s^2 | Y축 가속도 |
| acc_z | float64 | m/s^2 | Z축 가속도 |
| gyro_x | float64 | rad/s | X축 각속도 |
| gyro_y | float64 | rad/s | Y축 각속도 |
| gyro_z | float64 | rad/s | Z축 각속도 |

#### 6.1.2 카메라 프레임 (Camera Frame)

| 필드 | 유형 | 설명 |
|------|------|------|
| timestamp | int64 | 센서 타임스탬프 (나노초) |
| image | byte[] | 픽셀 데이터 (YUV420/RGB/Grayscale) |
| width | int32 | 픽셀 단위 이미지 너비 |
| height | int32 | 픽셀 단위 이미지 높이 |
| format | string | 픽셀 형식 식별자 |
| exposure_time | int64 | 노출 시간 (나노초) |
| iso | int32 | ISO 감도 값 |
| focal_length | float32 | 물리적 초점 거리 (mm) |

#### 6.1.3 포즈 (6DoF) (Pose)

| 필드 | 유형 | 단위 | 설명 |
|------|------|------|------|
| timestamp | int64 | 나노초 | 포즈 타임스탬프 |
| position_x | float64 | 미터 | X 위치 |
| position_y | float64 | 미터 | Y 위치 |
| position_z | float64 | 미터 | Z 위치 |
| orientation_w | float64 | - | 쿼터니언 W |
| orientation_x | float64 | - | 쿼터니언 X |
| orientation_y | float64 | - | 쿼터니언 Y |
| orientation_z | float64 | - | 쿼터니언 Z |

#### 6.1.4 캘리브레이션 파라미터 (Calibration Parameters)

| 필드 | 유형 | 설명 |
|------|------|------|
| camera_model | string | 카메라 모델 (pinhole, fisheye) |
| fx, fy | float64 | 초점 거리 (픽셀) |
| cx, cy | float64 | 주점 (픽셀) |
| distortion | float64[4-8] | 왜곡 계수 |
| T_cam_imu | float64[4x4] | 카메라-IMU 변환 |
| time_offset | float64 | 카메라-IMU 시간 오프셋 (초) |
| imu_noise | object | IMU 노이즈 파라미터 |

#### 6.1.5 맵 포인트 (Map Point)

| 필드 | 유형 | 설명 |
|------|------|------|
| id | int64 | 고유 포인트 식별자 |
| position | float64[3] | 3D 위치 (x, y, z) |
| color | uint8[3] | RGB 색상 (선택) |
| observations | int32 | 관측 횟수 |

### 6.2 데이터 관계 (Data Relationships)

```
+----------------+       +---------------+       +---------------+
|  IMU Sample    |       | Camera Frame  |       |     Pose      |
+----------------+       +---------------+       +---------------+
| timestamp (PK) |       | timestamp (PK)|       | timestamp (PK)|
| acc[3]         |       | image         |       | position[3]   |
| gyro[3]        |       | metadata      |       | orientation[4]|
+----------------+       +---------------+       +---------------+
        |                       |                       |
        +----------+------------+                       |
                   |                                    |
                   v                                    |
        +-------------------+                          |
        | Synchronized Data |                          |
        | (동기화된 데이터)   |                          |
        +-------------------+                          |
        | frame             |------------------------->|
        | imu_samples[]     |                          |
        +-------------------+                          |
                   |                                    |
                   v                                    |
        +-------------------+       +------------------+
        |   SLAM Engine     |------>|   Map Points     |
        |   (SLAM 엔진)      |       |   (맵 포인트)     |
        +-------------------+       +------------------+
```

### 6.3 데이터 제약조건 (Data Constraints)

| 제약조건 | 설명 | 시행 |
|---------|------|------|
| 타임스탬프 단조성 | IMU 타임스탬프는 엄격하게 증가해야 함 | 런타임 검증 |
| 프레임 레이트 범위 | 카메라 FPS는 15-60이어야 함 | 구성 검증 |
| IMU 레이트 범위 | IMU 레이트는 100-500 Hz이어야 함 | 구성 검증 |
| 캘리브레이션 유효성 | 모든 캘리브레이션 파라미터가 유효 범위 내여야 함 | 로드 시 검증 |
| 저장소 제한 | 50MB 여유 공간에서 녹화 중지 | 런타임 모니터링 |
| 버퍼 제한 | 최대 버퍼 크기 시행 | 메모리 관리 |

### 6.4 데이터 형식 (Data Formats)

#### 6.4.1 IMU CSV 형식 (저장용)

```csv
#timestamp[ns],ax[m/s^2],ay[m/s^2],az[m/s^2],gx[rad/s],gy[rad/s],gz[rad/s]
1000000000,0.1,-0.2,9.8,0.001,-0.002,0.001
1005000000,0.1,-0.2,9.81,0.001,-0.002,0.001
```

#### 6.4.2 메타데이터 JSON 형식

```json
{
  "format_version": "1.0",
  "device": {
    "model": "Pixel 6",
    "manufacturer": "Google",
    "android_version": "12",
    "api_level": 31
  },
  "camera": {
    "resolution": [1920, 1080],
    "fps": 30,
    "codec": "H.264",
    "timestamp_source": "SENSOR_TIMESTAMP",
    "camera2_level": "FULL"
  },
  "imu": {
    "accelerometer_type": "TYPE_ACCELEROMETER",
    "gyroscope_type": "TYPE_GYROSCOPE",
    "sampling_rate_hz": 200
  },
  "calibration": {
    "camera_model": "pinhole",
    "fx": 1500.0,
    "fy": 1500.0,
    "cx": 960.0,
    "cy": 540.0,
    "distortion_model": "radtan",
    "distortion_coeffs": [-0.28, 0.07, 0.0, 0.0],
    "T_cam_imu": [
      [1, 0, 0, 0],
      [0, 1, 0, 0],
      [0, 0, 1, 0],
      [0, 0, 0, 1]
    ],
    "time_offset_s": 0.0
  },
  "recording": {
    "start_time_utc": "2026-01-20T10:00:00.000Z",
    "duration_ms": 60000,
    "frame_count": 1800,
    "imu_sample_count": 12000,
    "file_size_bytes": 125000000
  }
}
```

#### 6.4.3 궤적 TUM 형식

```
# timestamp tx ty tz qx qy qz qw
1403636579.763555992 4.688319 -1.786938 0.783338 0.531152 -0.083869 -0.018332 0.843092
1403636579.863555992 4.688123 -1.786742 0.783421 0.531248 -0.083712 -0.018421 0.843012
```

#### 6.4.4 캘리브레이션 YAML 형식 (VINS-Mono 호환)

```yaml
%YAML:1.0

model_type: PINHOLE
camera_name: smartphone_cam
image_width: 1920
image_height: 1080

distortion_parameters:
  k1: -0.28
  k2: 0.07
  p1: 0.0
  p2: 0.0

projection_parameters:
  fx: 1500.0
  fy: 1500.0
  cx: 960.0
  cy: 540.0

body_T_cam0:
  - [1.0, 0.0, 0.0, 0.0]
  - [0.0, 1.0, 0.0, 0.0]
  - [0.0, 0.0, 1.0, 0.0]
  - [0.0, 0.0, 0.0, 1.0]

td: 0.0

imu_params:
  acc_n: 0.08
  acc_w: 0.00004
  gyr_n: 0.004
  gyr_w: 2.0e-6
```

---

## 7. 추적성 매트릭스

### 7.1 PRD에서 SRS로 추적성 (PRD to SRS Traceability)

| PRD 요구사항 | SRS 기능 | 유스케이스 | 우선순위 |
|-------------|---------|----------|---------|
| FR1.1 카메라 캡처 | SF-001 | UC-001 | P0 |
| FR1.2 IMU 캡처 | SF-002 | UC-002 | P0 |
| FR1.3 타임스탬프 동기화 | SF-003 | UC-003 | P0 |
| FR1.4 로컬 저장 | SF-004 | UC-004 | P0 |
| FR1.5 실시간 스트리밍 | SF-005 | UC-005 | P1 |
| FR1.6 설정 UI | SF-014 | UC-018 | P1 |
| FR1.7 상태 표시 | SF-015 | UC-019 | P1 |
| FR1.8 캘리브레이션 UI | SF-008 | UC-009, UC-010 | P2 |
| FR1.9 OIS 비활성화 | SF-001 (확장) | - | P2 |
| FR3.1 데이터 수신 | SF-006 | UC-006 | P0 |
| FR3.2 비디오 디코딩 | SF-006 | UC-006 | P0 |
| FR3.3 데이터 동기화 | SF-003, SF-006 | UC-003, UC-006 | P0 |
| FR3.4 SLAM 통합 | SF-007 | UC-007, UC-008 | P0 |
| FR3.5 시각화 | SF-012 | UC-016 | P1 |
| FR3.6 데이터 저장 | SF-004 | UC-004 | P1 |
| FR3.7 ROS 통합 | SF-013 | UC-017 | P1 |
| FR4.1 WebRTC 비디오 | SF-005 | UC-005 | P1 |
| FR4.2 UDP IMU | SF-005 | UC-005 | P1 |
| FR4.3 연결 관리 | SF-005 | UC-005 | P1 |
| FR4.4 버퍼링 | SF-005, SF-006 | UC-005, UC-006 | P1 |
| FR4.5 대역폭 적응 | SF-005 (확장) | UC-005 | P2 |
| FR5.1 타임스탬프 정렬 | SF-003 | UC-003 | P0 |
| FR5.2 IMU 보간 | SF-003 | UC-003 | P0 |
| FR5.3 드롭 프레임 처리 | SF-003, SF-005 | UC-003 | P1 |
| FR5.4 지연 보상 | SF-005, SF-006 | UC-005 | P1 |
| FR6.1 EuRoC 형식 | SF-004, SF-009 | UC-004, UC-011 | P0 |
| FR6.2 TUM 형식 | SF-011 | UC-013 | P1 |
| FR6.3 ROS bag | SF-011 (확장) | - | P1 |
| FR6.4 CSV/Binary | SF-004 | UC-004 | P0 |
| FR7.1 초기화 | SF-007 | UC-007 | P0 |
| FR7.2 추적 | SF-007 | UC-007, UC-012 | P0 |
| FR7.3 맵 관리 | SF-007 | UC-007 | P1 |
| FR7.4 루프 클로징 | SF-007 (확장) | - | P2 |
| FR7.5 재위치추정 | SF-007 | UC-007 | P1 |
| FR8.1 카메라 내부 파라미터 | SF-008 | UC-009 | P0 |
| FR8.2 카메라-IMU 외부 파라미터 | SF-008 | UC-010 | P1 |
| FR8.3 시간 오프셋 | SF-008 | UC-010 | P1 |
| FR8.4 IMU 노이즈 파라미터 | SF-008 (확장) | - | P2 |
| FR8.5 자동 캘리브레이션 | SF-008 (확장) | - | P2 |
| FR9.1 궤적 내보내기 | SF-011 | UC-013 | P0 |
| FR9.2 포인트 클라우드 | SF-011 | UC-015 | P1 |
| FR9.3 메쉬 | SF-011 (확장) | - | P2 |
| FR9.4 실시간 API | SF-011 | UC-014 | P1 |

### 7.2 유스케이스에서 PRD로 추적성 (Use Case to PRD Traceability)

| PRD 유스케이스 | SRS 유스케이스 | SRS 기능 |
|---------------|---------------|---------|
| UC1: 실시간 포즈 | UC-005, UC-006, UC-007, UC-012, UC-014, UC-017 | SF-005, SF-006, SF-007, SF-010, SF-011, SF-013 |
| UC2: 데이터 수집 | UC-001, UC-002, UC-003, UC-004 | SF-001, SF-002, SF-003, SF-004 |
| UC3: 오프라인 SLAM | UC-011, UC-013, UC-015 | SF-009, SF-011 |
| UC4: 캘리브레이션 | UC-009, UC-010 | SF-008 |
| UC5: 3D 맵 생성 | UC-015 | SF-011 |

### 7.3 NFR 추적성

| PRD NFR | SRS NFR ID | 사양 |
|---------|-----------|------|
| NFR1.1 종단간 지연 시간 | NFR-P001 | < 100 ms |
| NFR1.2 위치 정확도 | NFR-P002 | ATE RMSE < 0.1 m |
| NFR1.3 처리 속도 | NFR-P003 | >= 30 FPS |
| NFR1.4 IMU 샘플링 속도 | NFR-P004 | >= 200 Hz |
| NFR1.5 프레임 드롭률 | NFR-P005 | < 1% |
| NFR1.6 CPU 사용량 (앱) | NFR-P006 | < 50% |
| NFR1.7 메모리 사용량 (앱) | NFR-P007 | < 500 MB |
| NFR2.1 시스템 가동 시간 | NFR-R001 | >= 30 분 |
| NFR2.2 추적 유지율 | NFR-R002 | >= 95% |
| NFR2.3 데이터 무결성 | NFR-R003 | 100% |
| NFR2.4 오류 복구 | NFR-R004 | 자동 재연결 |
| NFR2.5 크래시율 | NFR-R005 | < 0.1% |
| NFR3.1 설치 시간 | NFR-U001 | < 30 분 |
| NFR3.2 캘리브레이션 시간 | NFR-U002 | < 10 분 |
| NFR3.3 학습 곡선 | NFR-U003 | < 1 일 |
| NFR3.4 문서화 | NFR-U004 | 100% 커버리지 |
| NFR3.5 오류 메시지 | NFR-U005 | 실행 가능 |
| NFR4.1 Android 버전 | NFR-C001 | 8.0+ |
| NFR4.2 iOS 버전 | NFR-C002 | 11.0+ |
| NFR4.3 PC OS | NFR-C003 | Ubuntu 20.04/22.04 |
| NFR4.4 ROS 버전 | NFR-C004 | Noetic, Humble |
| NFR4.5 지원 기기 | NFR-C005 | >= 20 모델 |
| NFR5.1 데이터 암호화 | NFR-S001 | DTLS |
| NFR5.2 로컬 데이터 보호 | NFR-S002 | 앱 샌드박스 |
| NFR5.3 최소 권한 | NFR-S003 | 필요한 것만 |
| NFR5.4 네트워크 인증 | NFR-S004 | 선택 사항 |
| NFR6.1 코드 커버리지 | NFR-M001 | >= 70% |
| NFR6.2 문서화 수준 | NFR-M002 | 모든 API |
| NFR6.3 모듈 결합도 | NFR-M003 | 느슨함 |
| NFR6.4 CI/CD | NFR-M004 | 자동화 |

---

## 8. 부록

### 8.1 분석 모델 (Analysis Models)

#### 8.1.1 상태 머신: SLAM 추적 (State Machine: SLAM Tracking)

```
                    +---------------+
                    | UNINITIALIZED |
                    | (초기화안됨)    |
                    +-------+-------+
                            |
                            | start()
                            v
                    +---------------+
           +------->| INITIALIZING  |
           |        | (초기화중)     |
           |        +-------+-------+
           |                |
           |                | initialization_complete
           |                v
           |        +---------------+
           |   +--->|   TRACKING    |<---+
           |   |    |   (추적중)     |    |
           |   |    +-------+-------+    |
           |   |            |            |
           |   |            | tracking_lost
           |   |            v            |
           |   |    +---------------+    |
           |   |    |     LOST      |    |
           |   |    |   (손실)       |    |
           |   |    +-------+-------+    |
           |   |            |            |
           |   |            | relocalization_success
           |   +------------+------------+
           |
           | reset() / initialization_failed
           |
           +---------------------------+
```

#### 8.1.2 데이터 흐름 다이어그램 (Data Flow Diagram)

```
[카메라]     [IMU]
    |           |
    v           v
+-------+   +-------+
|캡처    |   |캡처    |
+---+---+   +---+---+
    |           |
    +-----+-----+
          |
          v
    +-----------+
    |동기화      |
    +-----+-----+
          |
    +-----+-----+
    |           |
    v           v
+-------+   +-------+
|저장    |   |스트림  |
+-------+   +---+---+
                |
                v
          +-----------+
          |  수신      |
          +-----+-----+
                |
                v
          +-----------+
          |SLAM 엔진  |
          +-----+-----+
                |
    +-----------+-----------+
    |           |           |
    v           v           v
+------+   +-------+   +------+
|포즈   |   |  맵   |   |시각화 |
+------+   +-------+   +------+
```

### 8.2 미해결 이슈 (Open Issues)

| 이슈 ID | 설명 | 상태 | 담당자 |
|---------|------|------|-------|
| OI-001 | iOS 앱 개발 일정 TBD | 미결 | TBD |
| OI-002 | 자동 캘리브레이션 알고리즘 선정 | 미결 | TBD |
| OI-003 | 클라우드 처리 아키텍처 | 연기 | TBD |
| OI-004 | Unity/Unreal SDK 명세 | 연기 | TBD |
| OI-005 | 다중 카메라 지원 (스테레오) | 향후 | TBD |

### 8.3 개정 이력 (Revision History)

| 버전 | 날짜 | 작성자 | 변경사항 |
|------|------|-------|---------|
| 1.0.0 | 2026-01-24 | VI-SLAM 팀 | 초기 SRS 작성 |

---

## 승인 (Approval)

| 역할 | 이름 | 서명 | 날짜 |
|------|------|------|------|
| 기술 리드 | | | |
| QA 리드 | | | |
| 프로젝트 매니저 | | | |

---

*이 소프트웨어 요구사항 명세서는 VI-SLAM 시스템의 상세 요구사항을 정의합니다.*
*문서 작성일: 2026-01-24*
*버전: 1.0.0*
